<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analysis Methods (Expand Me First!) &mdash; TRANSIT v3.2.3 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/default.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Console Mode Cheat-Sheet" href="transit_console_cheatsheet.html" />
    <link rel="prev" title="Quality Control" href="transit_features.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TRANSIT
            <img src="_static/transit_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v3.2.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">TRANSIT MANUAL</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="transit_overview.html">TRANSIT Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="transit_install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="transit_running.html">Running TRANSIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="transit_features.html">Quality Control</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Analysis Methods (Expand Me First!)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gumbel">Gumbel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs-and-diagnostics">Outputs and diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-time">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#griffin">griffin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tn5gaps">Tn5Gaps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Outputs and diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hmm">HMM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-and-diagnostics">Output and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#resampling">Resampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#doing-resampling-with-a-combined-wig-file">Doing resampling with a combined_wig file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#doing-resampling-with-datasets-from-different-libraries">Doing resampling with datasets from different libraries.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#doing-resampling-between-different-strains">Doing resampling between different strains.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">Output and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mann-whitney-u-test-utest">Mann-Whitney U-test (utest)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genetic-interactions">Genetic Interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id24">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistical-significance">Statistical Significance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">Output and Diagnostics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#anova">ANOVA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id31">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id32">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id33">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">Output and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#zinb">ZINB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id37">How does it work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combined-wig-files">Combined wig files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samples-metadata-file">Samples Metadata File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#covariates-and-interactions">Covariates and Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#categorical-vs-numeric-covariates">Categorical vs Numeric Covariates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistical-significance-what-the-p-values-mean-in-the-zinb-output">Statistical Significance - What the P-values Mean in the ZINB Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id41">Output and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id42">Run-time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#normalization">Normalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#command-line">Command-line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pathway-enrichment-analysis">Pathway Enrichment Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id45">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id46">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auxilliary-pathway-files-in-transit-data-directory">Auxilliary Pathway Files in Transit Data Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#current-recommendations">Current Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id48">tnseq_stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id49">corrplot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id50">Usage:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id51">heatmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id52">Usage:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ttn-fitness">TTN-Fitness</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id53">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-of-running-the-ttn-fitness-methodology-on-the-sample-glycerol-data">Example of running the TTN-Fitness methodology on the sample glycerol data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transit_console_cheatsheet.html">Console Mode Cheat-Sheet</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TRANSIT Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit_interactions_tutorial.html">Tutorial: Genetic Interactions Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="transit_normalization_tutorial.html">Tutorial: Normalize datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="transit_export_tutorial.html">Tutorial: Export datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TPP Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tpp.html">TPP Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#running-tpp">Running TPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#mapping-to-genomes-with-multiple-contigs">Mapping to Genomes with Multiple Contigs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#overview-of-data-processing-procedure">Overview of Data Processing Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="tpp.html#statistics">Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transit.html">transit package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TRANSIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Analysis Methods (Expand Me First!)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/transit_methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="analysis-methods-expand-me-first">
<span id="analysis-methods"></span><h1>Analysis Methods (Expand Me First!)<a class="headerlink" href="#analysis-methods-expand-me-first" title="Permalink to this headline"></a></h1>
<p>TRANSIT has analysis methods capable of analyzing <strong>Himar1</strong> and
<strong>Tn5</strong> datasets.  Below is a description of some of the methods.</p>
<p>The analysis methods in Transit are also described in this <a class="reference external" href="https://orca1.tamu.edu/essentiality/transit/transit-manual.pdf">PDF manual</a> .</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="gumbel">
<span id="id1"></span><h2>Gumbel<a class="headerlink" href="#gumbel" title="Permalink to this headline"></a></h2>
<p>The Gumbel can be used to determine which genes are essential in a
single condition. It does a gene-by-gene analysis of the insertions at
TA sites with each gene, makes a call based on the longest consecutive
sequence of TA sites without insertion in the genes, calculates the
probability of this using a Bayesian model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended only for <strong>Himar1</strong> datasets.</p>
</div>
<section id="how-does-it-work">
<h3>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This method for identifying essential genes is based on analyzing
‘gaps’, or consecutive sequences of TA sites lacking insertions.
The statistical significance of the length of a gap is determined
using the Gumbel distribution, which is a form of an Extreme-Value distribution.</p>
<p>For a formal description of how this method works, see our paper <a class="reference internal" href="transit_overview.html#dejesus2013" id="id2"><span>[DeJesus2013]</span></a>:</p>
<div class="line-block">
<div class="line">DeJesus, M.A., Zhang, Y.J., Sassettti, C.M., Rubin, E.J.,
Sacchettini, J.C., and Ioerger, T.R. (2013).  <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/23361328">Bayesian analysis of
gene essentiality based on sequencing of transposon insertion
libraries.</a>
<em>Bioinformatics</em>, 29(6):695-703.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Update (2021) - Binomial</strong></p>
<p>Since the Gumbel method depends on the overall
saturation (percent of TA sites with insertions), it can sometimes
call a lot of smaller genes ‘Uncertain’.  This might reduce the total
number of essentials detected.  For example, if the saturation is
~30%, no genes with fewer than ~10 TA sites might confidently be
labeled as Essential.  In particular, there are often genes with no
insertions that look like they should obviously be called essential,
and yet, they are too short to be confidently called essential in
low-saturation datasets by the conservative Gumbel model.</p>
<p>To compensate for this, we have added a simple <strong>Binomial</strong> model for
detecting small genes totally lacking insertions (described in <a class="reference external" href="https://journals.asm.org/doi/full/10.1128/mSystems.00876-21">(Choudhery et al, 2021)</a>).  In
the output file, they are labled as ‘EB’ to distinguish them from
essentials (E) based on the Gumbel model.  The EB genes supplement
genes marked E by Gumbel, and the combination of the 2 groups (E and
EB) should be considered as ‘essentials’.  The number of genes in
each category is reported in a table in the header of the output file, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">for</span> <span class="n">an</span> <span class="n">M</span><span class="o">.</span> <span class="n">tuberculosis</span> <span class="n">TnSeq</span> <span class="n">dataset</span> <span class="k">with</span> <span class="mi">60</span><span class="o">%</span> <span class="n">saturation</span><span class="p">:)</span>
<span class="c1">#Summary of Essentiality Calls:</span>
<span class="c1">#  E  =  551 (essential based on Gumbel)</span>
<span class="c1">#  EB =   94 (essential based on Binomial)</span>
<span class="c1">#  NE = 2829 (non-essential)</span>
<span class="c1">#  U  =  262 (uncertain)</span>
<span class="c1">#  S  =  254 (too short)</span>

<span class="p">(</span><span class="k">for</span> <span class="n">an</span> <span class="n">M</span><span class="o">.</span> <span class="n">tuberculosis</span> <span class="n">TnSeq</span> <span class="n">dataset</span> <span class="k">with</span> <span class="mi">40</span><span class="o">%</span> <span class="n">saturation</span><span class="p">:)</span>
<span class="c1">#  E  =  194 (essential based on Gumbel)</span>
<span class="c1">#  EB =  315 (essential based on Binomial)</span>
<span class="c1">#  NE = 2441 (non-essential)</span>
<span class="c1">#  U  =  774 (uncertain)</span>
<span class="c1">#  S  =  266 (too short)</span>
</pre></div>
</div>
</section>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">gumbel</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">-</span><span class="n">s</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">samples</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">s</span> <span class="mi">10000</span>
      <span class="o">-</span><span class="n">b</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">Burn</span><span class="o">-</span><span class="ow">in</span> <span class="n">samples</span><span class="o">.</span> <span class="n">Default</span> <span class="o">-</span><span class="n">b</span> <span class="mi">500</span>
      <span class="o">-</span><span class="n">m</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Smallest</span> <span class="n">read</span><span class="o">-</span><span class="n">count</span> <span class="n">to</span> <span class="n">consider</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">m</span> <span class="mi">1</span>
      <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Trims</span> <span class="nb">all</span> <span class="n">but</span> <span class="n">every</span> <span class="n">t</span><span class="o">-</span><span class="n">th</span> <span class="n">value</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span>
      <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">How</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">replicates</span><span class="o">.</span> <span class="n">Sum</span> <span class="ow">or</span> <span class="n">Mean</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">r</span> <span class="n">Sum</span>
      <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><strong>Samples:</strong> Gumbel uses Metropolis-Hastings (MH) to generate samples
of posterior distributions. The default setting is to run the
simulation for 10,000 iterations. This is usually enough to assure
convergence of the sampler and to provide accurate estimates of
posterior probabilities. Less iterations may work, but at the risk of
lower accuracy.</p></li>
<li><p><strong>Burn-In:</strong> Because the MH sampler many not have stabilized in the
first few iterations, a “burn-in” period is defined. Samples obtained
in this “burn-in” period are discarded, and do not count towards
estimates.</p></li>
<li><p><strong>Trim:</strong> The MH sampler produces Markov samples that are correlated.
This parameter dictates how many samples must be attempted for every
sampled obtained. Increasing this parameter will decrease the
auto-correlation, at the cost of dramatically increasing the
run-time. For most situations, this parameter should be left at the
default of “1”.</p></li>
<li><p><strong>Minimum Read:</strong> The minimum read count that is considered a true
read. Because the Gumbel method depends on determining gaps of TA
sites lacking insertions, it may be susceptible to spurious reads
(e.g. errors). The default value of 1 will consider all reads as true
reads. A value of 2, for example, will ignore read counts of 1.</p></li>
<li><p><strong>Replicates:</strong> Determines how to deal with replicates by averaging
the read-counts or summing read counts across datasets. This should
not have an affect for the Gumbel method, aside from potentially
affecting spurious reads.</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="outputs-and-diagnostics">
<h3>Outputs and diagnostics<a class="headerlink" href="#outputs-and-diagnostics" title="Permalink to this headline"></a></h3>
<p>The Gumbel method generates a tab-separated output file at the location
chosen by the user. This file will automatically be loaded into the
Results Files section of the GUI, allowing you to display it as a table.
Alternatively, the file can be opened in a spreadsheet software like
Excel as a tab-separated file. The columns of the output file are
defined as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ORF</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Gene description.</p></td>
</tr>
<tr class="row-odd"><td><p>k</p></td>
<td><p>Number of Transposon Insertions Observed within the ORF.</p></td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>Total Number of TA dinucleotides within the ORF.</p></td>
</tr>
<tr class="row-odd"><td><p>r</p></td>
<td><p>Length of the Maximum Run of Non-Insertions observed.</p></td>
</tr>
<tr class="row-even"><td><p>s</p></td>
<td><p>Span of nucleotides for the Maximum Run of Non-Insertions.</p></td>
</tr>
<tr class="row-odd"><td><p>zbar</p></td>
<td><p>Posterior Probability of Essentiality.</p></td>
</tr>
<tr class="row-even"><td><p>Call</p></td>
<td><p>Essentiality call for the gene. Depends on FDR corrected thresholds. E=Essential U=Uncertain, NE=Non-Essential, S=too short</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line">Note: Technically, Bayesian models are used to calculate posterior
probabilities, not p-values (which is a concept associated with the
frequentist framework). However, we have implemented a method for
computing the approximate false-discovery rate (FDR) that serves a
similar purpose. This determines a threshold for significance on the
posterior probabilities that is corrected for multiple tests. The
actual thresholds used are reported in the headers of the output file
(and are near 1 for essentials and near 0 for non-essentials). There
can be many genes that score between the two thresholds (t1 &lt; zbar &lt;
t2). This reflects intrinsic uncertainty associated with either low
read counts, sparse insertion density, or small genes. If the
insertion_density is too low (&lt; ~30%), the method may not work as
well, and might indicate an unusually large number of Uncertain or
Essential genes.</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="run-time">
<h3>Run-time<a class="headerlink" href="#run-time" title="Permalink to this headline"></a></h3>
<p>The Gumbel method takes on the order of 10 minutes for 10,000 samples.
Run-time is linearly proportional to the ‘samples’ parameter, or length
of MH sampling trajectory. Other notes: Gumbel can be run on multiple
replicates; replicate datasets will be automatically merged.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
<hr class="transit-sectionend docutils" />
<section id="griffin">
<h2>griffin<a class="headerlink" href="#griffin" title="Permalink to this headline"></a></h2>
<p>This is an earlier version of the Gumbel method that
identifies essential genes based on how unlikely ‘gaps’
(or consecutive runs of TA sites with 0 insertions) are,
given the overall level of saturation.
It is a frequentist (non-Bayesian) model that uses
the Gumbel Extreme-Value Distribution as a likelihood function.
This is the analysis used in our paper on
<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/21980284">cholesterol catabolism (Griffin et al., 2011)</a>.
All things considered, you are probably better off using the
hierarchical-Bayesian Gumbel model above, which does a better job
of estimating internal parameters.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
<section id="tn5gaps">
<span id="id3"></span><h2>Tn5Gaps<a class="headerlink" href="#tn5gaps" title="Permalink to this headline"></a></h2>
<p>The Tn5Gaps method can be used to determine which genes are essential
in a single condition for <strong>Tn5</strong> datasets. It does an analysis of the
insertions at each site within the genome, makes a call for a given
gene based on the length of the most heavily overlapping run of sites
without insertions (gaps), calculates the probability of this using a
the Gumbel distribution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended only for <strong>Tn5</strong> datasets.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id4">
<h3>How does it work?<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<p>This method is loosely is based on the original gumbel analysis
method described in this paper:</p>
<p>Griffin, J.E., Gawronski, J.D., DeJesus, M.A., Ioerger, T.R., Akerley, B.J., Sassetti, C.M. (2011).
<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/21980284">High-resolution phenotypic profiling defines genes essential for mycobacterial survival and cholesterol catabolism.</a>  <em>PLoS Pathogens</em>, 7(9):e1002251.</p>
<p>The Tn5Gaps method modifies the original method in order to work on
Tn5 datasets, which have significantly lower saturation of insertion sites
than Himar1 datasets. The main difference comes from the fact that
the runs of non-insertion (or “gaps”) are analyzed throughout the whole
genome, including non-coding regions, instead of within single genes.
In doing so, the expected maximum run length is calculated and a
p-value can be derived for every run. A gene is then classified by
using the p-value of the run with the largest number of nucleotides
overlapping with the gene.</p>
<p>This method was tested on a Salmonella Tn5 dataset presented in this paper:</p>
<p>Langridge GC, Phan MD, Turner DJ, Perkins TT, Parts L, Haase J,
Charles I, Maskell DJ, Peters SE, Dougan G, Wain J, Parkhill J, Turner
AK. (2009). <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/19826075">Simultaneous assay of every Salmonella Typhi gene using one million
transposon mutants.</a> <em>Genome Res.</em> , 19(12):2308-16.</p>
<p>This data was downloaded from SRA (located <a class="reference external" href="http://trace.ncbi.nlm.nih.gov/Traces/sra/?study=ERP000051">here</a>) , and used to make
wig files (<a class="reference external" href="http://orca1.tamu.edu/essentiality/transit/data/salmonella_baseline.wig">baseline</a> and <a class="reference external" href="http://orca1.tamu.edu/essentiality/transit/data/salmonella_bile.wig">bile</a>) and the following 4 baseline datasets
were merged to make a wig file: (IL2_2122_1,3,6,8). Our analysis
produced 415 genes with adjusted p-values less than 0.05, indicating
essentiality, and the analysis from the above paper produced 356
essential genes. Of these 356 essential genes, 344 overlap with the
output of our analysis.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id5">
<h3>Usage<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">../../../</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tn5gaps</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>

    <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
    <span class="o">-</span><span class="n">m</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Smallest</span> <span class="n">read</span><span class="o">-</span><span class="n">count</span> <span class="n">to</span> <span class="n">consider</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">m</span> <span class="mi">1</span>
    <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">How</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">replicates</span><span class="o">.</span> <span class="n">Sum</span> <span class="ow">or</span> <span class="n">Mean</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">r</span> <span class="n">Sum</span>
    <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
    <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Parameters<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><strong>Minimum Read:</strong> The minimum read count that is considered a true read. Because the Gumbel method depends on determining gaps of TA sites lacking insertions, it may be suceptible to spurious reads (e.g. errors). The default value of 1 will consider all reads as true reads. A value of 2, for example, will ignore read counts of 1.</p></li>
<li><p><strong>Replicates:</strong> Determines how to deal with replicates by averaging the read-counts or suming read counts accross datasets. This should not have an affect for the Gumbel method, aside from potentially affecting spurious reads.</p></li>
<li><p><strong>-iN:</strong> Trimming of insertions in N-terminus (given as percentage of ORF length, e.g. “5” for 5%; default=0)</p></li>
<li><p><strong>-iC:</strong> Trimming of insertions in C-terminus (given as percentage of ORF length, e.g. “5” for 5%; default=0)</p></li>
</ul>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">PATH</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tn5gaps</span> <span class="n">salmonella_baseline</span><span class="o">.</span><span class="n">wig</span> <span class="n">Salmonella</span><span class="o">-</span><span class="n">Ty2</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">salmonella_baseline_tn5gaps_trimmed</span><span class="o">.</span><span class="n">dat</span> <span class="o">-</span><span class="n">m</span> <span class="mi">2</span> <span class="o">-</span><span class="n">r</span> <span class="n">Sum</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">5</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">5</span>
</pre></div>
</div>
<p>These input and output files can be downloaded from the <strong>Example Data</strong> section on the <a class="reference external" href="http://saclab.tamu.edu/essentiality/transit/index.html">Transit home page</a> .</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id7">
<h3>Outputs and diagnostics<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h3>
<p>The Tn5Gaps method generates a tab-separated output file at the
location chosen by the user. This file will automatically be loaded
into the Results Files section of the GUI, allowing you to display it
as a table. Alternatively, the file can be opened in a spreadsheet
software like Excel as a tab-separated file. The columns of the output
file are defined as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ORF</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Desc</p></td>
<td><p>Gene description.</p></td>
</tr>
<tr class="row-odd"><td><p>k</p></td>
<td><p>Number of Transposon Insertions Observed within the ORF.</p></td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>Total Number of TA dinucleotides within the ORF.</p></td>
</tr>
<tr class="row-odd"><td><p>r</p></td>
<td><p>Length of the Maximum Run of Non-Insertions observed.</p></td>
</tr>
<tr class="row-even"><td><p>ovr</p></td>
<td><p>The number of nucleotides in the overlap with the longest run partially covering the gene.</p></td>
</tr>
<tr class="row-odd"><td><p>lenovr</p></td>
<td><p>The length of the above run with the largest overlap with the gene.</p></td>
</tr>
<tr class="row-even"><td><p>pval</p></td>
<td><p>P-value calculated by the permutation test.</p></td>
</tr>
<tr class="row-odd"><td><p>padj</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg).</p></td>
</tr>
<tr class="row-even"><td><p>call</p></td>
<td><p>Essentiality call for the gene. Depends on FDR corrected thresholds. Essential or Non-Essential.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id8">
<h3>Run-time<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h3>
<p>The Tn5Gaps method takes on the order of 10 minutes.
Other notes: Tn5Gaps can be run on multiple replicates; replicate
datasets will be automatically merged.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section id="hmm">
<span id="id9"></span><h2>HMM<a class="headerlink" href="#hmm" title="Permalink to this headline"></a></h2>
<p>The HMM method can be used to determine the essentiality of the entire genome, as opposed to gene-level analysis of the other methods. It is capable of identifying regions that have unusually high or unusually low read counts (i.e. growth advantage or growth defect regions), in addition to the more common categories of essential and non-essential.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended only for <strong>Himar1</strong> datasets.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id10">
<h3>How does it work?<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line">For a formal description of how this method works, see our paper <a class="reference internal" href="transit_overview.html#dejesus2013hmm" id="id11"><span>[DeJesus2013HMM]</span></a>:</div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line">DeJesus, M.A., Ioerger, T.R. <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/24103077">A Hidden Markov Model for identifying essential and growth-defect regions in bacterial genomes from transposon insertion sequencing data.</a> <em>BMC Bioinformatics.</em> 2013. 14:303</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id12">
<h3>Example<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">hmm</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
          <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">How</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">replicates</span><span class="o">.</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">Mean</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">r</span> <span class="n">Mean</span>
          <span class="o">-</span><span class="n">l</span>              <span class="o">:=</span>  <span class="n">Perform</span> <span class="n">LOESS</span> <span class="n">Correction</span><span class="p">;</span> <span class="n">Helps</span> <span class="n">remove</span> <span class="n">possible</span> <span class="n">genomic</span> <span class="n">position</span> <span class="n">bias</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Off</span><span class="o">.</span>
          <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
          <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>Parameters<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h3>
<p>The HMM method automatically estimates the necessary statistical
parameters from the datasets. You can change how the method handles
replicate datasets:</p>
<ul class="simple">
<li><p><strong>Replicates:</strong> Determines how the HMM deals with replicate datasets
by either averaging the read-counts or summing read counts across
datasets. For regular datasets (i.e. mean-read count &gt; 100) the
recommended setting is to average read-counts together. For sparse
datasets, it summing read-counts may produce more accurate results.</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="output-and-diagnostics">
<h3>Output and Diagnostics<a class="headerlink" href="#output-and-diagnostics" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line">The HMM method outputs two files. The first file provides the most
likely assignment of states for all the TA sites in the genome. Sites
can belong to one of the following states: “E” (Essential), “GD”
(Growth-Defect), “NE” (Non-Essential), or “GA” (Growth-Advantage). In
addition, the output includes the probability of the particular site
belonging to the given state. The columns of this file are defined as
follows:</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 89%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column #</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Coordinate of TA site</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Observed Read Counts</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Probability for ES state</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Probability for GD state</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Probability for NE state</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Probability for GA state</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>State Classification (ES = Essential, GD = Growth Defect, NE = Non-Essential, GA = Growth-Defect)</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Gene(s) that share(s) the TA site.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line">The second file provides a gene-level classification for all the
genes in the genome. Genes are classified as “E” (Essential), “GD”
(Growth-Defect), “NE” (Non-Essential), or “GA” (Growth-Advantage)
depending on the number of sites within the gene that belong to those
states.</div>
</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Gene Name</p></td>
</tr>
<tr class="row-even"><td><p>Desc</p></td>
<td><p>Gene Description</p></td>
</tr>
<tr class="row-odd"><td><p>N</p></td>
<td><p>Number of TA sites</p></td>
</tr>
<tr class="row-even"><td><p>n0</p></td>
<td><p>Number of sites labeled ES (Essential)</p></td>
</tr>
<tr class="row-odd"><td><p>n1</p></td>
<td><p>Number of sites labeled GD (Growth-Defect)</p></td>
</tr>
<tr class="row-even"><td><p>n2</p></td>
<td><p>Number of sites labeled NE (Non-Essential)</p></td>
</tr>
<tr class="row-odd"><td><p>n3</p></td>
<td><p>Number of sites labeled GA (Growth-Advantage)</p></td>
</tr>
<tr class="row-even"><td><p>Avg. Insertions</p></td>
<td><p>Mean insertion rate within the gene</p></td>
</tr>
<tr class="row-odd"><td><p>Avg. Reads</p></td>
<td><p>Mean read count within the gene</p></td>
</tr>
<tr class="row-even"><td><p>State Call</p></td>
<td><p>State Classification (ES = Essential, GD = Growth Defect, NE = Non-Essential, GA = Growth-Defect)</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line">Note: Libraries that are too sparse (e.g. &lt; 30%) or which contain
very low read-counts may be problematic for the HMM method, causing it
to label too many Growth-Defect genes.</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id14">
<h3>Run-time<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line">The HMM method takes less than 10 minutes to complete. The parameters
of the method should not affect the running-time.</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section id="resampling">
<span id="id15"></span><h2>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline"></a></h2>
<p>The resampling method is a comparative analysis the allows that can be
used to determine conditional essentiality of genes. It is based on a
permutation test, and is capable of determining read-counts that are
significantly different across conditions.</p>
<p>See <a class="reference internal" href="#gsea"><span class="std std-ref">Pathway Enrichment Analysis</span></a> for post-processing the hits to
determine if the hits are associated with a particular functional catogory
of genes or known biological pathway.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used for both <strong>Himar1</strong> and <strong>Tn5</strong> datasets</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id16">
<h3>How does it work?<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h3>
<p>This technique has yet to be formally published in the context of
differential essentiality analysis. Briefly, the read-counts at each
genes are determined for each replicate of each condition. The mean
read-count in condition A is subtracted from the mean read-count in
condition B, to obtain an observed difference in means. The TA
sites are then permuted for a given number of “samples”. For each one of
these permutations, the difference in read-counts is determined. This
forms a null distribution, from which a p-value is calculated for the
original, observed difference in read-counts.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id17">
<h3>Usage<a class="headerlink" href="#id17" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">control</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">experimental</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">-</span><span class="n">s</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">samples</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">s</span> <span class="mi">10000</span>
      <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>
      <span class="o">-</span><span class="n">h</span>              <span class="o">:=</span>  <span class="n">Output</span> <span class="n">histogram</span> <span class="n">of</span> <span class="n">the</span> <span class="n">permutations</span> <span class="k">for</span> <span class="n">each</span> <span class="n">gene</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">Off</span><span class="o">.</span>
      <span class="o">-</span><span class="n">a</span>              <span class="o">:=</span>  <span class="n">Perform</span> <span class="n">adaptive</span> <span class="n">resampling</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">Off</span><span class="o">.</span>
      <span class="o">-</span><span class="n">ez</span>             <span class="o">:=</span>  <span class="n">Exclude</span> <span class="n">rows</span> <span class="k">with</span> <span class="n">zero</span> <span class="n">accross</span> <span class="n">conditions</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">off</span>
                          <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">include</span> <span class="n">rows</span> <span class="k">with</span> <span class="n">zeros</span><span class="p">)</span><span class="o">.</span>
      <span class="o">-</span><span class="n">PC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Pseudocounts</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">calculating</span> <span class="n">LFC</span><span class="o">.</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
      <span class="o">-</span><span class="n">l</span>              <span class="o">:=</span>  <span class="n">Perform</span> <span class="n">LOESS</span> <span class="n">Correction</span><span class="p">;</span> <span class="n">Helps</span> <span class="n">remove</span> <span class="n">possible</span> <span class="n">genomic</span> <span class="n">position</span> <span class="n">bias</span><span class="o">.</span>
                          <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">Off</span><span class="o">.</span>
      <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
      <span class="o">--</span><span class="n">ctrl_lib</span>      <span class="o">:=</span>  <span class="n">String</span> <span class="n">of</span> <span class="n">letters</span> <span class="n">representing</span> <span class="n">library</span> <span class="n">of</span> <span class="n">control</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">order</span>
                          <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;AABB&#39;</span><span class="o">.</span> <span class="n">Default</span> <span class="n">empty</span><span class="o">.</span> <span class="n">Letters</span> <span class="n">used</span> <span class="n">must</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span> <span class="o">--</span><span class="n">exp_lib</span>
                          <span class="n">If</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="p">,</span> <span class="n">resampling</span> <span class="n">will</span> <span class="n">limit</span> <span class="n">permutations</span> <span class="n">to</span> <span class="n">within</span><span class="o">-</span><span class="n">libraries</span><span class="o">.</span>

      <span class="o">--</span><span class="n">exp_lib</span>       <span class="o">:=</span>  <span class="n">String</span> <span class="n">of</span> <span class="n">letters</span> <span class="n">representing</span> <span class="n">library</span> <span class="n">of</span> <span class="n">experimental</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">order</span>
                          <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;ABAB&#39;</span><span class="o">.</span> <span class="n">Default</span> <span class="n">empty</span><span class="o">.</span> <span class="n">Letters</span> <span class="n">used</span> <span class="n">must</span> <span class="n">also</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span> <span class="o">--</span><span class="n">ctrl_lib</span>
                          <span class="n">If</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span><span class="p">,</span> <span class="n">resampling</span> <span class="n">will</span> <span class="n">limit</span> <span class="n">permutations</span> <span class="n">to</span> <span class="n">within</span><span class="o">-</span><span class="n">libraries</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="id18">
<h3>Parameters<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h3>
<p>The resampling method is non-parametric, and therefore does not require
any parameters governing the distributions or the model. The following
parameters are available for the method:</p>
<ul class="simple">
<li><p><strong>Samples:</strong> The number of samples (permutations) to perform. The
larger the number of samples, the more resolution the p-values
calculated will have, at the expense of longer computation time. The
resampling method runs on 10,000 samples by default.</p></li>
<li><p><strong>Output Histograms:</strong> Determines whether to output .png images of
the histograms obtained from resampling the difference in
read-counts.</p></li>
<li><p><strong>Adaptive Resampling:</strong> An optional “adaptive” version of resampling
which accelerates the calculation by terminating early for genes
which are likely not significant. This dramatically speeds up the
computation at the cost of less accurate estimates for those genes
that terminate early (i.e. deemed not significant). This option is
OFF by default. (see Notes below)</p></li>
<li><p><strong>Include Zeros:</strong> Select to include  sites that are zero. This is the
preferred behavior, however, unselecting this (thus ignoring sites that)
are zero accross all dataset (i.e. completely empty), is useful for
decreasing running time (specially for large datasets like Tn5).</p></li>
<li><p><strong>Normalization Method:</strong> Determines which normalization method to
use when comparing datasets. Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>--ctrl_lib, --exp_lib:</strong> These are for doing resampling with datasets from multiple libraries, see below.</p></li>
<li><p><strong>-iN, -iC:</strong> Trimming of TA sites near N- and C-terminus.
The default for trimming TA sites in the termini of ORFs is 0.
However, TA sites in the stop codon (e.g. TAG) are automatically excluded.
Trimming is specified as a percentage (as an integer), so, for example,
if you want to trim TA sites within 5% of the termini, you would
add the flags ‘-iN 5 -iC 5’ (not 0.05).</p></li>
<li><p><strong>-PC</strong>: Pseudocounts used in calculation of LFCs (log-fold-changes, see Output and Diagnostics) in
resampling output file.
To suppress the appearance of artifacts due to high-magnitude of LFCs from
genes with low insertion counts (which
are more susceptible to noise), one can increase the pseudocounts using <a href="#id19"><span class="problematic" id="id20">`</span></a>-PC’.
Increasing PC to a value like 5 (which is
reasonable, given that TTR normalization scales data so average insertion counts is around 100)
can further reduce the appearance of artifacts (genes with low counts but large LFCs).
However, changing pseudocounts only affects the LFCs, and will not change the number of significant genes.</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline"></a></h3>
<p>I recommend using -a (adaptive resampling). It runs much faster, and the p-values
will be very close to a full non-adaptive run (all 10,000 samples).</p>
<p>Occasionally, people ask if resampling can be done on intergenic regions as well.
It could be done pretty easily (for example by making a prot_table with coordinates
for the regions between genes).  But it is usually not worthwhile, because most
intergenic regions are small (&lt;100 bp) contain very few TA sites (often 0-2),
making it difficult to make confident calls on essentiality.</p>
</section>
<section id="doing-resampling-with-a-combined-wig-file">
<h3>Doing resampling with a combined_wig file<a class="headerlink" href="#doing-resampling-with-a-combined-wig-file" title="Permalink to this headline"></a></h3>
<p>Resampling can also now take a <a class="reference internal" href="#combined-wig">combined_wig</a> file as input (containing insertion counts
for multiple sample), along with a <a class="reference internal" href="#samples-metadata">samples_metadata</a> file
that describes the samples. This mode is indicated with a ‘-c’ flag.
If you want to compare more than two conditions, see <a class="reference internal" href="#zinb"><span class="std std-ref">ZINB</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span>

<span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="o">-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">combined_wig</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">samples_metadata</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">control_condition_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">experimental_condition_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>

<span class="n">example</span><span class="p">:</span>

<span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="o">-</span><span class="n">c</span> <span class="n">antibiotic_combined_wig</span><span class="o">.</span><span class="n">txt</span> <span class="n">antibiotic_samples_metadata</span><span class="o">.</span><span class="n">txt</span> <span class="n">Untreated</span> <span class="n">Isoniazid</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">results</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
</section>
<section id="doing-resampling-with-datasets-from-different-libraries">
<h3>Doing resampling with datasets from different libraries.<a class="headerlink" href="#doing-resampling-with-datasets-from-different-libraries" title="Permalink to this headline"></a></h3>
<p>In most cases, comparisons are done among samples (replicates) from
the same library evaluated in two different conditions.  But if the
samples themselves come from different libraries, then this could
introduce extra variability, the way resampling is normally done.  To
compensate for this, if you specify which libraries each dataset comes
from, the permutations will be restricted to permuting counts only
among samples within each library.  Statistical significance is still
determined from all the data in the end (by comparing the obversed
difference of means between the two conditions to a null distribution).
Of course, this method makes most sense when you have at least 1 replicate
from each library in each condition.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="doing-resampling-between-different-strains">
<h3>Doing resampling between different strains.<a class="headerlink" href="#doing-resampling-between-different-strains" title="Permalink to this headline"></a></h3>
<p>The most common case is that resampling is done among replicates all
from the same Tn library, and hence all the datasets (fastq files) are
mapped to the same refence genome.  Occasionally, it is useful to
compare TnSeq datasets between two different strains, such as a
reference strain and a clinical isolate from a different lineage.
Suppose for simplicity that you want to compare one replicate from
strain A (e.g. H37Rv) and one replicate from strain B (e.g. CDC1551).
Resampling was not originally designed to handle this case.  The
problem is that the TA sites in the .wig files with insertion counts
might have different coordinates (because of shifts due to indels
between the genomes).  Furthermore, a given gene might not even have
the same number of TA sites in the two strains (due to SNPs).  A
simplistic solution is to just map both datasets to the same genome
sequence (say H37Rv, for example).  Then a resampling comparison could
be run as usual, because the TA sites would all be on the same
coordinate system. This is not ideal, however, because some reads of
strain B might not map properly to genome A due to SNPs or indels
between the genomes.  In fact, in more divergent organisms with higher
genetic diversity, this can cause entire regions to look artificially
essential, because reads fail to map in genes with a large number of
SNPs, resulting in the apparent absence of transposon insertions.</p>
<p>A better approach is to map each library to the custom genome sequence
of its own strain (using TPP).  It turns out the resampling can still
be applied (since it is fundamentally a test on the difference of the
<em>mean</em> insertion count in each gene).  The key to making this work,
aside from mapping each library to its own genome sequence, is that
you need an annotation (prot_table) for the second strain that has
been “adapted” from the first strain.  This is because,
to do a comparison between conditions for a gene, Transit needs to be
able to determine which TA sites fall in that gene for each strain.
This can be achieved by producing a “modified” prot_table, where the
START and END coordinates of each ORF in strain B have been adjusted
according to an alignment between genome A and genome B.  You can use
this web app: <a class="reference external" href="http://saclab.tamu.edu/cgi-bin/iutils/app.cgi/">Prot_table Adjustment Tool</a>, to create a
modifed prot_table, given the prot_table for one strain and the fasta
files for both genomes (which will be aligned).  In other words, the
app allows you to create ‘B.prot_table’ from ‘A.prot_table’ (and ‘A.fna’
and ‘B.fna’).</p>
<p>Once you have created B.prot_table, all you need to do is provide
<em>both</em> prot_tables to resampling (either through the GUI, or on the
command-line), as a comma-separated list.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">resampling</span> <span class="n">Rv_1_H37Rv</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">Rv_2_H37Rv</span><span class="o">.</span><span class="n">wig</span> <span class="mi">632_1_632</span><span class="n">WGS</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="mi">632_2_632</span><span class="n">WGS</span><span class="o">.</span><span class="n">wig</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span><span class="p">,</span><span class="mi">632</span><span class="n">WGS</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">resampling_output</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<p>In this example, 2 replicates from H37Rv (which had been mapped to
H37Rv.fna by TPP) were compared to 2 replicates from strain 632 (which
had been mapped to 632WGS.fna, the custom genome seq for strain 632).
The important point is that <strong>two annotations</strong> are given in the 3rd
arg on the command-line: <strong>H37Rv.prot_table,632WGS.prot_table</strong>.  The
assumption is that the ORF boundaries for H37Rv will be used to find
TA sites in Rv_1_H37Rv.wig and Rv_2_H37Rv.wig, and the ORF boundaries
in 632WGS.prot_table (which had been adapted from H37Rv.prot_table
using the web app above) will be used to find TA sites in the
corrsponding regions in 632_1_632WGS.wig and 632_2_632WGS.wig.</p>
<p>Note that, in contrast to handling datasets from different libraries
disucssed above, in this case, the assumption is that all replicates
in condition A will be from one library (and one strain), and all
replicates in condition B will be from another library (another strain).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id21">
<h3>Output and Diagnostics<a class="headerlink" href="#id21" title="Permalink to this headline"></a></h3>
<p>The resampling method outputs a tab-delimited file with results for each
gene in the genome. P-values are adjusted for multiple comparisons using
the Benjamini-Hochberg procedure (called “q-values” or “p-adj.”). A
typical threshold for conditional essentiality on is q-value &lt; 0.05.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Gene description.</p></td>
</tr>
<tr class="row-odd"><td><p>Sites</p></td>
<td><p>Number of TA sites in the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Mean Ctrl</p></td>
<td><p>Mean of read counts in condition 1. (avg over TA sites and reps)</p></td>
</tr>
<tr class="row-odd"><td><p>Mean Exp</p></td>
<td><p>Mean of read counts in condition 2.</p></td>
</tr>
<tr class="row-even"><td><p>log2FC</p></td>
<td><p>Log-fold-change of exp (treatment) over ctrl (untreated)</p></td>
</tr>
<tr class="row-odd"><td><p>Sum Ctrl</p></td>
<td><p>Sum of read counts in condition 1.</p></td>
</tr>
<tr class="row-even"><td><p>Sum Exp</p></td>
<td><p>Sum of read counts in condition 2.</p></td>
</tr>
<tr class="row-odd"><td><p>Delta Mean</p></td>
<td><p>Difference in the MEAN insertion counts.</p></td>
</tr>
<tr class="row-even"><td><p>p-value</p></td>
<td><p>P-value calculated by the permutation test.</p></td>
</tr>
<tr class="row-odd"><td><p>Adj. p-value</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg)</p></td>
</tr>
</tbody>
</table>
<p><strong>log2FC:</strong> (log-fold-change, LFC)
For each gene, the LFC is calculated as the log-base-2 of the
ratio of mean insertion counts in the experimental (treated) condition vs. the
control condition (untreated, reference).
The default is PC=1, which avoids the result being undefined
for genes with means of 0 in either condition.  Pseudocounts can be
changed using the -PC flag (above).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LFC</span> <span class="o">=</span> <span class="n">log2</span><span class="p">((</span><span class="n">mean_insertions_in_exp</span> <span class="o">+</span> <span class="n">PC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mean_insertions_in_ctrl</span> <span class="o">+</span> <span class="n">PC</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id22">
<h3>Run-time<a class="headerlink" href="#id22" title="Permalink to this headline"></a></h3>
<p>A typical run of the resampling method with 10,000 samples will take
around 45 minutes (with the histogram option ON). Using the <em>adaptive
resampling</em> option (-a), the run-time is reduced to around 10 minutes.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
<hr class="transit-sectionend docutils" />
<section id="mann-whitney-u-test-utest">
<h2>Mann-Whitney U-test (utest)<a class="headerlink" href="#mann-whitney-u-test-utest" title="Permalink to this headline"></a></h2>
<p>This is a method for comparing datasets from a TnSeq library evaluated in
two different conditions, analogous to resampling.
This is a <em>rank-based</em> test on whether the level of insertions in a
gene or chromosomal region are significantly higher or lower in one
condition than the other.  Effectively, the insertion counts at the TA
sites in the region are pooled and sorted.  Then the combined ranks of the counts
in region A are compared to those in region B, and p-value is calculated
that reflects whether there is a significant difference in the ranks.
The advantage of this method is that it is less sensitive to outliers
(a unusually high insertion count at just a single TA site).
A reference for this method is <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/25104751">(Santa Maria et al., 2014)</a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
<section id="genetic-interactions">
<span id="id23"></span><h2>Genetic Interactions<a class="headerlink" href="#genetic-interactions" title="Permalink to this headline"></a></h2>
<p>The genetic interactions (GI) method is a comparative analysis used
used to determine genetic interactions. It is a Bayesian method
that estimates the distribution of log fold-changes (logFC) in two
strain backgrounds under different conditions, and identifies significantly
large changes in enrichment (delta_logFC) to identify those genes
that imply a genetic interaction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used for both <strong>Himar1</strong> and <strong>Tn5</strong> datasets</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id24">
<h3>How does it work?<a class="headerlink" href="#id24" title="Permalink to this headline"></a></h3>
<p>GI performs a comparison among 4 groups of datasets, strain A and B assessed in conditions 1 and 2 (e.g. control vs treatment).
It looks for interactions where the response to the treatment (i.e. effect on insertion counts) depends on the strain.</p>
<p>If you think of the effect of treatment as a log-fold-change (e.g. of
the insert counts between control and treatment in strain A), which is
like a “slope”, then the interacting genes are those that exhibit a difference
in the effect of the treatment between the strains, and hence a difference in the
slopes between strain A and B (represented by ‘delta_LFC’ in the output file).</p>
<div class="line-block">
<div class="line">For a formal description of how this method works, see our paper <a class="reference internal" href="transit_overview.html#dejesus2017nar" id="id25"><span>[DeJesus2017NAR]</span></a>:</div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line">DeJesus, M.A., Nambi, S., Smith, C.M., Baker, R.E., Sassetti, C.M., Ioerger, T.R. <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/28334803">Statistical analysis of genetic interactions in Tn-Seq data.</a> <em>Nucleic Acids Research.</em> 2017. 45(11):e93. doi: 10.1093/nar/gkx128.</div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="statistical-significance">
<h3>Statistical Significance<a class="headerlink" href="#statistical-significance" title="Permalink to this headline"></a></h3>
<p>The computation that is done by GI is to compute the posterior distribution of the delta_LFC (or mean change in slopes)
through Bayesian sampling.
The primary method to determine significance of genes is whethter this the mean_delta_LFC is significantly differnt than 0.
However, since the mean_delta_LFC is a distribution, we represent it by a Highest Density Interval, HDI, which is
similar to a 95% confidence interval.  Furthermore, rather than asking whether the HDI overlaps 0 exactly, we expand the interval
around 0 to a Region of Probable Equivalence (ROPE), which is set to [-0.5,0.5] by default.  Hence the significant genes
are those for which the HDI does not overlap the ROPE.  GI has a flag to  adjust the size of the ROPE, if desired.</p>
<p>In the GI output file, the final column give the significance call, along with type of interaction.
If a gene is not significant, it will be marked with “<strong>No Interaction</strong>” (for the HDI method, meaning HDI overlaps the ROPE).
If a gene IS significant, then its interaction will be cateogrized in 3 types (see NAR paper):</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Aggravating</strong> - mean_delta_LFC is negative; gene is more required in treatment than control in the B strain, compared to the A strain</p></li>
<li><p><strong>Suppressive</strong> - mean_delta_LFC is positive, and the gene was not conditionally essential in strain A (flat slope), but becomes conditionally non-essential in strain B when treated (positive slope)</p></li>
<li><p><strong>Alleviating</strong> - mean_delta_LFC is positive, but the conditional requirement (negative slope) of the gene in strain A with treatment is “cancelled” by the modification in strain B</p></li>
</ul>
</div></blockquote>
<img alt="_images/genetic_interaction_types.png" src="_images/genetic_interaction_types.png" />
<p>A limitation of this HDI approach is that it is discrete (i.e. overlap is either True or False), but does not provide a quantitative metric
for the degree of overlap.  Thus a second method for assessing significance of genetic interactions is to compute
the probability of overlap.  The lower the probability, the more differnt the delta_LFC is from 0, indicating a more
significant interaction.  In this case, genes with prob &lt; 0.05 are considered interactions and classified by the 3 types above,
while genes with prob &gt;= 0.05 are marked as “No Interaction”.</p>
<p>In addition, since we are calculating significance for thousands of genes in parallel,
many researchers prefer to have some method for correcting for multiple tests, to control the false discovery rate.
However, FDR correction is generally used only for frequentist analyses, and he GI method is fundamentally a Bayesian approach.
Technically, in a Bayesian framework, FDR correction is not needed.  Any adjustment for expectations about number of hits
would be achieved through adjusting parameters for prior distributions.  Nonetheless, GI includes options for
two methods that approximate FDR correction: <strong>BFDR</strong> (Bayesian False Discovery Rate correction,
<a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/15054023/">Newton M.A., Noueiry A., Sarkar D., Ahlquist P. (2004). Detecting differential gene expression with a semiparametric hierarchical
mixture method. Biostatistics, 5:155–176.</a>) and FWER (Familty-Wise
Error Rate control).  When these corrections are applied, a threshold of 0.05 for the adjusted probability of overlap
is used for each, and this determines which
genes are classified as interacting (1 of 3 types) or  marked as “No Interaction”, as above.</p>
<p>In order to enable users to evaluate these various methods for determining significance of interactions,
a ‘-signif’ flag is provided for the GI method.  The options are:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>-signif HDI</strong>: significant genes are those for which the HDI does not overlap the ROPE</p></li>
<li><p><strong>-signif prob</strong>: significant genes are those with prob &lt; 0.05, where ‘prob’ is porbability that HDI overlap the ROPE (default)</p></li>
<li><p><strong>-signif BFDR</strong>: significant genes are those with adjusted prob &lt; 0.05, where prob is adjusted by the BFDR method</p></li>
<li><p><strong>-signif FWER</strong>: significant genes are those with adjusted prob &lt; 0.05, where prob is adjusted by the FWER method</p></li>
</ul>
</div></blockquote>
<p>‘-signif prob’ is the default method.</p>
<p>In the output file, the genes are sorted by the probability that the HDI overlaps the ROPE.
The genes at the top are rougly the genes with the highest absolute value of mean_delta_LFC.</p>
</section>
<section id="id26">
<h3>Usage<a class="headerlink" href="#id26" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">/</span><span class="n">pacific</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ioerger</span><span class="o">/</span><span class="n">transit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">GI</span> <span class="o">&lt;</span><span class="n">wigs_for_strA_cond1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">wigs_for_strA_cond2</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">wigs_for_strB_cond1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">wigs_for_strB_cond2</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span> <span class="ow">or</span> <span class="n">GFF3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>

      <span class="n">GI</span> <span class="n">performs</span> <span class="n">a</span> <span class="n">comparison</span> <span class="n">among</span> <span class="mi">4</span> <span class="n">groups</span> <span class="n">of</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">strain</span> <span class="n">A</span> <span class="ow">and</span> <span class="n">B</span> <span class="n">assessed</span> <span class="ow">in</span> <span class="n">conditions</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">2</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">control</span> <span class="n">vs</span> <span class="n">treatment</span><span class="p">)</span><span class="o">.</span>
      <span class="n">It</span> <span class="n">looks</span> <span class="k">for</span> <span class="n">interactions</span> <span class="n">where</span> <span class="n">the</span> <span class="n">response</span> <span class="n">to</span> <span class="n">the</span> <span class="n">treatment</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">effect</span> <span class="n">on</span> <span class="n">insertion</span> <span class="n">counts</span><span class="p">)</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">the</span> <span class="n">strain</span> <span class="p">(</span><span class="n">output</span> <span class="n">variable</span><span class="p">:</span> <span class="n">delta_LFC</span><span class="p">)</span><span class="o">.</span>
      <span class="n">Provide</span> <span class="n">replicates</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">group</span> <span class="k">as</span> <span class="n">a</span> <span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">wig</span> <span class="n">files</span><span class="o">.</span>
      <span class="n">HDI</span> <span class="ow">is</span> <span class="n">highest</span> <span class="n">density</span> <span class="n">interval</span> <span class="k">for</span> <span class="n">posterior</span> <span class="n">distribution</span> <span class="n">of</span> <span class="n">delta_LFC</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">like</span> <span class="n">a</span> <span class="n">confidence</span> <span class="n">interval</span> <span class="n">on</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">slopes</span><span class="o">.</span>
      <span class="n">Genes</span> <span class="n">are</span> <span class="nb">sorted</span> <span class="n">by</span> <span class="n">probability</span> <span class="n">of</span> <span class="n">HDI</span> <span class="n">overlapping</span> <span class="k">with</span> <span class="n">ROPE</span><span class="o">.</span> <span class="p">(</span><span class="n">genes</span> <span class="k">with</span> <span class="n">the</span> <span class="n">highest</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mean_delta_logFC</span><span class="p">)</span> <span class="n">are</span> <span class="n">near</span> <span class="n">the</span> <span class="n">top</span><span class="p">,</span> <span class="n">approximately</span><span class="p">)</span>
      <span class="n">Significant</span> <span class="n">genes</span> <span class="n">are</span> <span class="n">indicated</span> <span class="n">by</span> <span class="s1">&#39;Type of Interaction&#39;</span> <span class="n">column</span> <span class="p">(</span><span class="n">No</span> <span class="n">Interaction</span><span class="p">,</span> <span class="n">Aggravating</span><span class="p">,</span> <span class="n">Alleviating</span><span class="p">,</span> <span class="n">Suppressive</span><span class="p">)</span><span class="o">.</span>
        <span class="n">By</span> <span class="n">default</span><span class="p">,</span> <span class="n">hits</span> <span class="n">are</span> <span class="n">defined</span> <span class="k">as</span> <span class="s2">&quot;Is HDI outside of ROPE?&quot;</span><span class="o">=</span><span class="n">TRUE</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">non</span><span class="o">-</span><span class="n">overlap</span> <span class="n">of</span> <span class="n">delta_LFC</span> <span class="n">posterior</span> <span class="n">distritbuion</span> <span class="k">with</span> <span class="n">Region</span> <span class="n">of</span> <span class="n">Probably</span> <span class="n">Equivalence</span> <span class="n">around</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">Alternative</span> <span class="n">methods</span> <span class="k">for</span> <span class="n">significance</span><span class="p">:</span> <span class="n">use</span> <span class="o">-</span><span class="n">signif</span> <span class="n">flag</span> <span class="k">with</span> <span class="n">prob</span><span class="p">,</span> <span class="n">BFDR</span><span class="p">,</span> <span class="ow">or</span> <span class="n">FWER</span><span class="o">.</span> <span class="n">These</span> <span class="n">affect</span> <span class="s1">&#39;Type of Interaction&#39;</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">which</span> <span class="n">genes</span> <span class="n">are</span> <span class="n">labeled</span> <span class="s1">&#39;No Interaction&#39;</span><span class="p">)</span>

      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">-</span><span class="n">s</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>    <span class="o">:=</span>  <span class="n">Number</span> <span class="n">of</span> <span class="n">samples</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">s</span> <span class="mi">10000</span>
      <span class="o">--</span><span class="n">rope</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>  <span class="o">:=</span>  <span class="n">Region</span> <span class="n">of</span> <span class="n">Practical</span> <span class="n">Equivalence</span><span class="o">.</span> <span class="n">Area</span> <span class="n">around</span> <span class="mi">0</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="mi">0</span> <span class="o">+/-</span> <span class="n">ROPE</span><span class="p">)</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">NOT</span> <span class="n">of</span> <span class="n">interest</span><span class="o">.</span> <span class="n">Can</span> <span class="n">be</span> <span class="n">thought</span> <span class="n">of</span> <span class="n">similar</span> <span class="n">to</span> <span class="n">the</span> <span class="n">area</span> <span class="n">of</span> <span class="n">the</span> <span class="n">null</span><span class="o">-</span><span class="n">hypothesis</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">--</span><span class="n">rope</span> <span class="mf">0.5</span>
      <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>
      <span class="o">-</span><span class="n">iz</span>             <span class="o">:=</span>  <span class="n">Include</span> <span class="n">rows</span> <span class="k">with</span> <span class="n">zero</span> <span class="n">across</span> <span class="n">conditions</span><span class="o">.</span>
      <span class="o">-</span><span class="n">l</span>              <span class="o">:=</span>  <span class="n">Perform</span> <span class="n">LOESS</span> <span class="n">Correction</span><span class="p">;</span> <span class="n">Helps</span> <span class="n">remove</span> <span class="n">possible</span> <span class="n">genomic</span> <span class="n">position</span> <span class="n">bias</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">Turned</span> <span class="n">Off</span><span class="o">.</span>
      <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">at</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">signif</span> <span class="n">HDI</span>     <span class="o">:=</span>  <span class="p">(</span><span class="n">default</span><span class="p">)</span> <span class="n">Significant</span> <span class="k">if</span> <span class="n">HDI</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">overlap</span> <span class="n">ROPE</span><span class="p">;</span> <span class="k">if</span> <span class="n">HDI</span> <span class="n">overlaps</span> <span class="n">ROPE</span><span class="p">,</span> <span class="s1">&#39;Type of Interaction&#39;</span> <span class="ow">is</span> <span class="nb">set</span> <span class="n">to</span> <span class="s1">&#39;No Interaction&#39;</span>
      <span class="o">-</span><span class="n">signif</span> <span class="n">prob</span>    <span class="o">:=</span>  <span class="n">Optionally</span><span class="p">,</span> <span class="n">significant</span> <span class="n">hits</span> <span class="n">are</span> <span class="n">re</span><span class="o">-</span><span class="n">defined</span> <span class="n">based</span> <span class="n">on</span> <span class="n">probability</span> <span class="p">(</span><span class="n">degree</span><span class="p">)</span> <span class="n">of</span> <span class="n">overlap</span> <span class="n">of</span> <span class="n">HDI</span> <span class="k">with</span> <span class="n">ROPE</span><span class="p">,</span> <span class="n">prob</span><span class="o">&lt;</span><span class="mf">0.05</span> <span class="p">(</span><span class="n">no</span> <span class="n">adjustment</span><span class="p">)</span>
      <span class="o">-</span><span class="n">signif</span> <span class="n">BFDR</span>    <span class="o">:=</span>  <span class="n">Apply</span> <span class="s2">&quot;Bayesian&quot;</span> <span class="n">FDR</span> <span class="n">correction</span> <span class="p">(</span><span class="n">see</span> <span class="n">doc</span><span class="p">)</span> <span class="n">to</span> <span class="n">adjust</span> <span class="n">HDI</span><span class="o">-</span><span class="n">ROPE</span> <span class="n">overlap</span> <span class="n">probabilities</span> <span class="n">so</span> <span class="n">that</span> <span class="n">significant</span> <span class="n">hits</span> <span class="n">are</span> <span class="n">re</span><span class="o">-</span><span class="n">defined</span> <span class="k">as</span> <span class="n">BFDR</span><span class="o">&lt;</span><span class="mf">0.05</span>
      <span class="o">-</span><span class="n">signif</span> <span class="n">FWER</span>    <span class="o">:=</span>  <span class="n">Apply</span> <span class="s2">&quot;Bayesian&quot;</span> <span class="n">FWER</span> <span class="n">correction</span> <span class="p">(</span><span class="n">see</span> <span class="n">doc</span><span class="p">)</span> <span class="n">to</span> <span class="n">adjust</span> <span class="n">HDI</span><span class="o">-</span><span class="n">ROPE</span> <span class="n">overlap</span> <span class="n">probabilities</span> <span class="n">so</span> <span class="n">that</span> <span class="n">significant</span> <span class="n">hits</span> <span class="n">are</span> <span class="n">re</span><span class="o">-</span><span class="n">defined</span> <span class="k">as</span> <span class="n">FWER</span><span class="o">&lt;</span><span class="mf">0.05</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3>Example<a class="headerlink" href="#id27" title="Permalink to this headline"></a></h3>
<p>In this example, the effect of a knockout of SigB is being evaluated for its effect on tolerance of isoniazid.
Some genes may become more essential (or less) in the presence of INH in the wild-type strain.
The genes implied to interact with SigB are those whose response to INH changes in the knock-out strain compared to the wild-type.
Note there are 2 replicates in each of the 4 groups of datasets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">GI</span> <span class="n">WT_untreated1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">WT_untreated2</span><span class="o">.</span><span class="n">wig</span> <span class="n">WT_INH_1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">WT_INH_2</span><span class="o">.</span><span class="n">wig</span> <span class="n">delta_SigB_untreated1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">delta_SigB_untreated2</span><span class="o">.</span><span class="n">wig</span> <span class="n">delta_SigB_INH_1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">delta_SigB_INH_2</span><span class="o">.</span><span class="n">wig</span> <span class="n">mc2_155_tamu</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">GI_delta_SigB_INH</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="id28">
<h3>Parameters<a class="headerlink" href="#id28" title="Permalink to this headline"></a></h3>
<p>The resampling method is non-parametric, and therefore does not require
any parameters governing the distributions or the model. The following
parameters are available for the method:</p>
<ul class="simple">
<li><p><strong>Samples:</strong> The number of samples (permutations) to perform. The
larger the number of samples, the more resolution the p-values
calculated will have, at the expense of longer computation time. The
resampling method runs on 10,000 samples by default.</p></li>
<li><p><strong>ROPE:</strong> Region of Practical Equivalence. This region defines an area
around 0.0 that represents differences in the log fold-change that are
practically equivalent to zero. This aids in ignoring spurious changes
in the logFC that would otherwise be identified under a strict
null-hypothesis of no difference.</p></li>
<li><p><strong>Include Zeros:</strong> Select to include  sites that are zero. This is the
preferred behavior, however, unselecting this (thus ignoring sites that)
are zero accross all dataset (i.e. completely empty), is useful for
decreasing running time (specially for large datasets like Tn5).</p></li>
<li><p><strong>Normalization Method:</strong> Determines which normalization method to
use when comparing datasets. Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>Significance Method:</strong></p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>-signif HDI: significant genes are those for which the HDI does not overlap the ROPE</p></li>
<li><p>-signif prob: significant genes are those with prob &lt; 0.05, where ‘prob’ is porbability that HDI overlap the ROPE (default)</p></li>
<li><p>-signif BFDR: significant genes are those with adjusted prob &lt; 0.05, where prob is adjusted by the BFDR method</p></li>
<li><p>-signif FWER: significant genes are those with adjusted prob &lt; 0.05, where prob is adjusted by the FWER method</p></li>
</ul>
</div></blockquote>
</section>
<section id="id29">
<h3>Output and Diagnostics<a class="headerlink" href="#id29" title="Permalink to this headline"></a></h3>
<p>The GI method outputs a tab-delimited file with results for each
gene in the genome.
All genes are sorted by significance using the probability that the HDI overlaps the ROPE.
Significant genes are those NOT marked with ‘No Interaction’ in the last column.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>Number of TA Sites</p></td>
<td><p>Number of TA sites in the gene.</p></td>
</tr>
<tr class="row-odd"><td><p>Mean count (Strain A Condition 1)</p></td>
<td><p>Mean read count in strain A, condition 1</p></td>
</tr>
<tr class="row-even"><td><p>Mean count (Strain A Condition 2)</p></td>
<td><p>Mean read count in strain A, condition 2</p></td>
</tr>
<tr class="row-odd"><td><p>Mean count (Strain B Condition 1)</p></td>
<td><p>Mean read count in strain B, condition 1</p></td>
</tr>
<tr class="row-even"><td><p>Mean count (Strain B Condition 2)</p></td>
<td><p>Mean read count in strain B, condition 2</p></td>
</tr>
<tr class="row-odd"><td><p>Mean logFC (Strain A)</p></td>
<td><p>The log2 fold-change in read-count for strain A</p></td>
</tr>
<tr class="row-even"><td><p>Mean logFC (Strain B)</p></td>
<td><p>The log2 fold-change in read-count for strain B</p></td>
</tr>
<tr class="row-odd"><td><p>Mean delta logFC</p></td>
<td><p>The difference in log2 fold-change between B and A</p></td>
</tr>
<tr class="row-even"><td><p>Lower Bound delta logFC</p></td>
<td><p>Lower bound of the difference (delta logFC)</p></td>
</tr>
<tr class="row-odd"><td><p>Upper Bound delta logFC</p></td>
<td><p>Upper bound of the difference (delta logFC)</p></td>
</tr>
<tr class="row-even"><td><p>Prob. of delta-logFC being within ROPE</p></td>
<td><p>Portion of the delta-logFC within ROPE</p></td>
</tr>
<tr class="row-odd"><td><p>Adjusted Probability (BFDR)</p></td>
<td><p>Posterior probability adjusted for comparisons</p></td>
</tr>
<tr class="row-even"><td><p>Is HDI outside ROPE?</p></td>
<td><p>True/False whether the delta-logFC overlaps ROPE</p></td>
</tr>
<tr class="row-odd"><td><p>Type of Interaction</p></td>
<td><p>Final classification.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="anova">
<span id="id30"></span><h2>ANOVA<a class="headerlink" href="#anova" title="Permalink to this headline"></a></h2>
<p>The Anova (Analysis of variance) method is used to determine which genes
exhibit statistically significant variability of insertion counts across multiple conditions.
Unlike other methods which take a comma-separated list of wig files as input,
the method takes a <em>combined_wig</em> file (which combined multiple datasets in one file)
and a <em>samples_metadata</em> file (which describes which samples/replicates belong
to which experimental conditions).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id31">
<h3>How does it work?<a class="headerlink" href="#id31" title="Permalink to this headline"></a></h3>
<p>The method performs the <a class="reference external" href="https://en.wikipedia.org/wiki/Analysis_of_variance?oldformat=true#The_F-test">One-way anova test</a> for each gene across conditions.
It takes into account variability of normalized transposon insertion counts among TA sites
and among replicates,
to determine if the differences among the mean counts for each condition are significant.</p>
</section>
<section id="id32">
<h3>Example<a class="headerlink" href="#id32" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">anova</span> <span class="o">&lt;</span><span class="n">combined</span> <span class="n">wig</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">samples_metadata</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>         <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>
      <span class="o">--</span><span class="n">exclude</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="o">...&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">ignore</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="kc">None</span>
      <span class="o">--</span><span class="n">include</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="o">...&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">include</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">All</span>
      <span class="o">--</span><span class="n">ref</span> <span class="o">&lt;</span><span class="n">cond</span><span class="o">&gt;</span> <span class="o">:=</span> <span class="n">which</span> <span class="n">condition</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">a</span> <span class="n">reference</span> <span class="k">for</span> <span class="n">calculating</span> <span class="n">LFCs</span> <span class="p">(</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="k">if</span> <span class="n">multiple</span> <span class="n">conditions</span><span class="p">)</span> <span class="p">(</span><span class="n">by</span> <span class="n">default</span><span class="p">,</span> <span class="n">LFCs</span> <span class="k">for</span> <span class="n">each</span> <span class="n">condition</span> <span class="n">are</span> <span class="n">computed</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">the</span> <span class="n">grandmean</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">condintions</span><span class="p">)</span>
      <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span> <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span> <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occurring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="p">(</span><span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">0</span>
      <span class="o">-</span><span class="n">PC</span>         <span class="o">:=</span> <span class="n">Pseudocounts</span> <span class="n">to</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">calculating</span> <span class="n">LFCs</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">PC</span> <span class="mi">5</span>
</pre></div>
</div>
<p>The output file generated by ANOVA identifies which genes exhibit statistically
significant variability in counts across conditions (see Output and Diagnostics below).</p>
<p>Note: the combined_wig input file can be generated from multiple wig
files through the Transit GUI
(File-&gt;Export-&gt;Selected_Datasets-&gt;Combined_wig), or via the ‘export’
command on the command-line (see <a class="reference internal" href="#combined-wig">combined_wig</a>).</p>
<p>Format of the <strong>samples metadata file</strong>: a tab-separated file (which you can edit in Excel)
with 3 columns: Id, Condition, and Filename (it must have these headers).  You can include
other columns of info, but do not include additional rows.  Individual rows can be
commented out by prefixing them with a ‘#’.  Here is an example of a samples metadata file:
The filenames should match what is shown in the header of the combined_wig (including pathnames, if present).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>      <span class="n">Condition</span>    <span class="n">Filename</span>
<span class="n">glyc1</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep1</span><span class="o">.</span><span class="n">wig</span>
<span class="n">glyc2</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep2</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol1</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep1</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep2</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep3</span><span class="o">.</span><span class="n">wig</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3>Parameters<a class="headerlink" href="#id33" title="Permalink to this headline"></a></h3>
<p>The following parameters are available for the ANOVA method:</p>
<ul class="simple">
<li><p><strong>--include-conditions:</strong> Includes the given set of conditions from the ZINB test. Conditions not in this list are ignored. Note: this is useful for specifying the order in which the columns are listed in the output file.</p></li>
<li><p><strong>--exclude-conditions:</strong> Can use this to drop conditions not of interest.</p></li>
<li><p><strong>--ref:</strong> Specify which condition to use as a reference for computing LFCs.
By default, LFCs for each gene in each condition are calculated with respect
to the <em>grand mean</em> count across all conditions (so conditions with higher counts will be balanced
with conditions with lower counts).  However, if there is a defined reference condition
in the data, it may be specified using <strong>--ref</strong> (in which case LFCs for that condition will
be around 0, and will be positive or negative for the other conditions, depending on whether
counts are higher or lower than the reference condintion.  If there is more than one
condition to use as reference (i.e. pooled), they may be given as a comma-separated list.</p></li>
<li><p><strong>-n</strong> Normalization Method. Determines which normalization method to
use when comparing datasets. Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>-PC</strong> Pseudocounts to use in calculating LFCs (see below). Default: -PC 5</p></li>
</ul>
</section>
<section id="id34">
<h3>Output and Diagnostics<a class="headerlink" href="#id34" title="Permalink to this headline"></a></h3>
<p>The anova method outputs a tab-delimited file with results for each
gene in the genome. P-values are adjusted for multiple comparisons using
the Benjamini-Hochberg procedure (called “q-values” or “p-adj.”). A
typical threshold for conditional essentiality on is q-value &lt; 0.05.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>TAs</p></td>
<td><p>Number of TA sites in Gene</p></td>
</tr>
<tr class="row-odd"><td><p>Means…</p></td>
<td><p>Mean readcounts for each condition</p></td>
</tr>
<tr class="row-even"><td><p>LFCs…</p></td>
<td><p>Log-fold-changes of counts in each condition vs mean across all conditions</p></td>
</tr>
<tr class="row-odd"><td><p>p-value</p></td>
<td><p>P-value calculated by the Anova test.</p></td>
</tr>
<tr class="row-even"><td><p>p-adj</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>Debug information (If any)</p></td>
</tr>
</tbody>
</table>
<p><strong>LFCs</strong> (log-fold-changes):
For each condition, the LFC is calculated as the log-base-2 of the
ratio of mean insertion count in that condition <strong>relative to the
mean of means across all the conditions</strong>.
Pseudocount are incorporated to reduce the impact of noise on LFCs, based on the formula below.
The pseudocounts can be adjusted using the -PC flag.
Changing the pseudocounts (via -PC) can reduce the artifactual appearance of genes with
high-magnitude LFCs but that have small overall counts (which are susceptible to noise).
Changing the pseudocounts will not affect the analysis of statistical significance and hence number of varying genes, however.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LFC</span> <span class="o">=</span> <span class="n">log2</span><span class="p">((</span><span class="n">mean_insertions_in_condition</span> <span class="o">+</span> <span class="n">PC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mean_of_means_across_all_conditions</span> <span class="o">+</span> <span class="n">PC</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id35">
<h3>Run-time<a class="headerlink" href="#id35" title="Permalink to this headline"></a></h3>
<p>A typical run of the anova method takes less than 1 minute for a combined wig file with 6 conditions, 3 replicates per condition.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="zinb">
<span id="id36"></span><h2>ZINB<a class="headerlink" href="#zinb" title="Permalink to this headline"></a></h2>
<p>The ZINB (Zero-Inflated Negative Binomial) method is used to determine
which genes exhibit <em>statistically significant variability across multiple
conditions</em>, in either the magnitude of insertion counts or local saturation, agnostically (in any one condition compared to the others).
Like <a class="reference internal" href="#anova"><span class="std std-ref">ANOVA</span></a>, the ZINB method takes a
<em>combined_wig</em> file (which combines multiple datasets in one file) and
a <em>samples_metadata</em> file (which describes which samples/replicates
belong to which experimental conditions).</p>
<p>ZINB can be applied to two or more conditions at a time.  Thus it
subsumes <a class="reference internal" href="#resampling"><span class="std std-ref">resampling</span></a>.  Our testing suggests that
ZINB typically identifies 10-20% more varying genes than resampling
(and vastly out-performs ANOVA for detecting significant variability
across conditions).  Furthermore, because of how ZINB treats magnitude
of read counts separately from local saturation in a gene, it
occasionally identifies genes with variability not detectable by
resampling analysis.</p>
<p>Note: ZINB analysis requires R (statistical analysis software)
to be installed on your system, along with the ‘pscl’ R package.
See <a class="reference internal" href="transit_install.html#install-zinb"><span class="std std-ref">Installation Instructions</span></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="id37">
<h3>How does it work?<a class="headerlink" href="#id37" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line">For a formal description of how this method works, see our paper <a class="reference internal" href="transit_overview.html#zinb" id="id38"><span>[ZINB]</span></a>:</div>
<div class="line"><br /></div>
<div class="line-block">
<div class="line">Subramaniyam S, DeJesus MA, Zaveri A, Smith CM, Baker RE, Ehrt S, Schnappinger D, Sassetti CM, Ioerger TR. (2019).  <a class="reference external" href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-3156-z">Statistical analysis of variability in TnSeq data across conditions using Zero-Inflated Negative Binomial regression.</a>, <em>BMC Bioinformatics</em>. 2019 Nov 21;20(1):603. doi: 10.1186/s12859-019-3156-z.</div>
</div>
</div>
</section>
<section id="id39">
<h3>Example<a class="headerlink" href="#id39" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="o">&lt;</span><span class="n">combined</span> <span class="n">wig</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">samples_metadata</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Optional</span> <span class="n">Arguments</span><span class="p">]</span>
      <span class="n">Optional</span> <span class="n">Arguments</span><span class="p">:</span>
      <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>         <span class="o">:=</span>  <span class="n">Normalization</span> <span class="n">method</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>
      <span class="o">--</span><span class="n">exclude</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="o">...&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">ignore</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="kc">None</span>
      <span class="o">--</span><span class="n">include</span><span class="o">-</span><span class="n">conditions</span> <span class="o">&lt;</span><span class="n">cond1</span><span class="p">,</span><span class="o">...&gt;</span> <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="n">to</span> <span class="n">include</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="n">All</span>
      <span class="o">--</span><span class="n">ref</span> <span class="o">&lt;</span><span class="n">cond</span><span class="o">&gt;</span> <span class="o">:=</span> <span class="n">which</span> <span class="n">condition</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">a</span> <span class="n">reference</span> <span class="k">for</span> <span class="n">calculating</span> <span class="n">LFCs</span> <span class="p">(</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="k">if</span> <span class="n">more</span> <span class="n">than</span> <span class="n">one</span><span class="p">)</span> <span class="p">(</span><span class="n">by</span> <span class="n">default</span><span class="p">,</span> <span class="n">LFCs</span> <span class="k">for</span> <span class="n">each</span> <span class="n">condition</span> <span class="n">are</span> <span class="n">computed</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">the</span> <span class="n">grandmean</span> <span class="n">across</span> <span class="nb">all</span> <span class="n">condintions</span><span class="p">)</span>
      <span class="o">-</span><span class="n">iN</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="n">of</span> <span class="n">the</span> <span class="n">N</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iN</span> <span class="mi">5</span>
      <span class="o">-</span><span class="n">iC</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>     <span class="o">:=</span>  <span class="n">Ignore</span> <span class="n">TAs</span> <span class="n">occuring</span> <span class="n">within</span> <span class="n">given</span> <span class="n">percentage</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">terminus</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">iC</span> <span class="mi">5</span>
      <span class="o">-</span><span class="n">PC</span> <span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span>         <span class="o">:=</span>  <span class="n">Pseudocounts</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">calculating</span> <span class="n">LFCs</span> <span class="ow">in</span> <span class="n">output</span> <span class="n">file</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="o">-</span><span class="n">PC</span> <span class="mi">5</span>
      <span class="o">--</span><span class="n">condition</span>     <span class="o">:=</span>  <span class="n">columnname</span> <span class="p">(</span><span class="ow">in</span> <span class="n">samples_metadata</span><span class="p">)</span> <span class="n">to</span> <span class="n">use</span> <span class="k">as</span> <span class="n">the</span> <span class="n">Condition</span><span class="o">.</span> <span class="n">Default</span><span class="p">:</span> <span class="s2">&quot;Condition&quot;</span>
      <span class="o">--</span><span class="n">covars</span> <span class="o">&lt;</span><span class="n">covar1</span><span class="p">,</span><span class="n">covar2</span><span class="o">...&gt;</span>     <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">covariates</span> <span class="p">(</span><span class="ow">in</span> <span class="n">metadata</span> <span class="n">file</span><span class="p">)</span> <span class="n">to</span> <span class="n">include</span><span class="p">,</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span>
      <span class="o">--</span><span class="n">interactions</span> <span class="o">&lt;</span><span class="n">covar1</span><span class="p">,</span><span class="n">covar2</span><span class="o">...&gt;</span>     <span class="o">:=</span>  <span class="n">Comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">covariates</span> <span class="n">to</span> <span class="n">include</span><span class="p">,</span> <span class="n">that</span> <span class="n">interact</span> <span class="k">with</span> <span class="n">the</span> <span class="n">condition</span> <span class="k">for</span> <span class="n">the</span> <span class="n">analysis</span><span class="o">.</span>
      <span class="o">-</span><span class="n">v</span> <span class="o">:=</span> <span class="n">verbose</span><span class="p">,</span> <span class="nb">print</span> <span class="n">out</span> <span class="n">the</span> <span class="n">model</span> <span class="n">coefficients</span> <span class="k">for</span> <span class="n">each</span> <span class="n">gene</span><span class="o">.</span>
      <span class="o">--</span><span class="n">gene</span> <span class="o">&lt;</span><span class="n">Orf</span> <span class="nb">id</span> <span class="ow">or</span> <span class="n">Gene</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">:=</span> <span class="n">Run</span> <span class="n">method</span> <span class="k">for</span> <span class="n">one</span> <span class="n">gene</span> <span class="ow">and</span> <span class="nb">print</span> <span class="n">model</span> <span class="n">output</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="combined-wig-files">
<span id="combined-wig"></span><h3>Combined wig files<a class="headerlink" href="#combined-wig-files" title="Permalink to this headline"></a></h3>
<p>Transit now supports a new file format called ‘combined_wig’ which basically
combines multiple wig files into one file (with multiple columns).  This is
used for some of the new analysis methods for larger collections of datasets, like <a class="reference internal" href="#anova"><span class="std std-ref">Anova</span></a>, <a class="reference internal" href="#zinb"><span class="std std-ref">ZINB</span></a>.
Combined_wig files can created through the Transit GUI
(File-&gt;Export-&gt;Selected_Datasets-&gt;Combined_wig), or via the command line.
You can specify the normalization method you want to use with a flag.
TTR is the default, but other relevant normalization options would be ‘nonorm’
(i.e. preserve raw counts) and ‘betageom’ (this corrects for skew, but is slow).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">export</span> <span class="n">combined_wig</span> <span class="o">--</span><span class="n">help</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">export</span> <span class="n">combined_wig</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span>

<span class="o">&gt;</span> <span class="n">python3</span> <span class="o">../</span><span class="n">transit</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">export</span> <span class="n">combined_wig</span> <span class="n">Rv_1_H37RvRef</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">Rv_2_H37RvRef</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">Rv_3_H37RvRef</span><span class="o">.</span><span class="n">wig</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">clinicals_combined_TTR</span><span class="o">.</span><span class="n">wig</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>
</pre></div>
</div>
</section>
<section id="samples-metadata-file">
<span id="samples-metadata"></span><h3>Samples Metadata File<a class="headerlink" href="#samples-metadata-file" title="Permalink to this headline"></a></h3>
<p>Format of the <em>samples_metadata</em> file: a tab-separated file (which you
can edit in Excel) with 3 columns: Id, Condition, and Filename (it
must have these headers).  You can include other columns of info, but
do not include additional rows.  Individual rows can be commented out
by prefixing them with a ‘#’.  Here is an example of a samples
metadata file: The filenames should match what is shown in the header
of the combined_wig (including pathnames, if present).</p>
<p>Note: the Condition column should have a unique label for each distinct condition (the same label shared only among replicates).
If there are attributes that distinguish the conditions (such as strain, treatment, etc), they could be included as additional columns (e.g. covariates).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>      <span class="n">Condition</span>    <span class="n">Filename</span>
<span class="n">glyc1</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep1</span><span class="o">.</span><span class="n">wig</span>
<span class="n">glyc2</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep2</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol1</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep1</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep2</span><span class="o">.</span><span class="n">wig</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep3</span><span class="o">.</span><span class="n">wig</span>
</pre></div>
</div>
</section>
<section id="id40">
<h3>Parameters<a class="headerlink" href="#id40" title="Permalink to this headline"></a></h3>
<p>The following parameters are available for the ZINB method:</p>
<ul class="simple">
<li><p><strong>--include-conditions:</strong> Includes the given set of conditions from the ZINB test. Conditions not in this list are ignored. Note: this is useful for specifying the order in which the columns are listed in the output file.</p></li>
<li><p><strong>--exclude-conditions:</strong> Ignores the given set of conditions from the ZINB test.</p></li>
<li><p><strong>--ref:</strong> which condition to use as a reference when computing LFCs in the output file. By default, LFCs for each condition are computed relative to the grandmean across all condintions.</p></li>
<li><p><strong>Normalization Method:</strong> Determines which normalization method to
use when comparing datasets. Proper normalization is important as it
ensures that other sources of variability are not mistakenly treated
as real differences. See the <a class="reference internal" href="#normalization"><span class="std std-ref">Normalization</span></a> section for a description
of normalization method available in TRANSIT.</p></li>
<li><p><strong>Covariates:</strong> If additional covariates distinguishing the samples are available, such as library, timepoint, or genotype, they may be incorporated in the test.</p></li>
</ul>
</section>
<section id="covariates-and-interactions">
<h3>Covariates and Interactions<a class="headerlink" href="#covariates-and-interactions" title="Permalink to this headline"></a></h3>
<p>While ZINB is focus on identifying variability of insertion counts across conditions,
the linear model also allows you to take other variables into account.
There are two types of auxilliary variables: <em>covariates</em> and <em>interactions</em>. These can be provided as extra columns in the samples metadata file.
Covariates are attributes of the individual samples that could have a systematic
effect on the insertion counts which we would like to account for and subsequently ignore
(like nuissance variables). Examples include things like batch or library.</p>
<p>Interactions are extra variables for which we want to test their effect on the
main variable (or condition).  For example, suppose we collect TnSeq data at several
different timepoints (e.g. length of incubation or infection).  If we just test
time as the condition, we will be identifying genes that vary over time (if timepoints
are numeric, think of the model as fitting a ‘slope’ to the counts).
But suppose we have data for both a wild-type and knock-out strain.  Then we might be
interested in genes for which the time-dependent behavior <em>differs</em> between the two
strains (think: different ‘slopes’). In such a case, we would say strain and time interact.</p>
<p>If covariates distinguishing the samples are available,
such as batch or library, they may be
incorporated in the ZINB model by using the <strong>--covars</strong> flag and samples
metadata file. For example, consider the following samples metadata
file, with a column describing the batch information of each
replicate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ID</span>      <span class="n">Condition</span>    <span class="n">Filename</span>                                     <span class="n">Batch</span>
<span class="n">glyc1</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep1</span><span class="o">.</span><span class="n">wig</span>        <span class="n">B1</span>
<span class="n">glyc2</span>   <span class="n">glycerol</span>     <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">glycerol_rep2</span><span class="o">.</span><span class="n">wig</span>        <span class="n">B2</span>
<span class="n">chol1</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep1</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B1</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep2</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B2</span>
<span class="n">chol2</span>   <span class="n">cholesterol</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">example_data</span><span class="o">/</span><span class="n">cholesterol_rep3</span><span class="o">.</span><span class="n">wig</span>     <span class="n">B2</span>
</pre></div>
</div>
<p>This information can be included to eliminate variability due to batch by using
the <strong>--covars</strong> flag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">covars</span> <span class="n">Batch</span>
</pre></div>
</div>
<p>Similarly, an interaction variable may be included in the model.
This is specified by the user with the <strong>--interactions</strong> flag,
followed by the name of a column in the samples metadata to test as the interaction
with the condition. If there are multiple interactions, they may be given as a comma-separated list.</p>
<p>To give an example,
consider an experiment where the condition represents
a treatment (e.g. with values ‘treated’ and ‘control’), and we have another column
called Strain (with values ‘wild-type’ and ‘mutant’).
If we want to test whether the effect of the treatment (versus control)
differs depending on the strain, we could do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">interactions</span> <span class="n">Strain</span>
</pre></div>
</div>
<p>In this case, the condition is implicitly assumed to be the column in the samples metadata file
labeled ‘Condition’.  If you want to specify a different column to use as the primary condition to
test (for example, if Treatment were a distinct column), you can use the <strong>--condition</strong> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">zinb</span> <span class="n">combined</span><span class="o">.</span><span class="n">wig</span> <span class="n">samples</span><span class="o">.</span><span class="n">metadata</span> <span class="n">prot</span><span class="o">.</span><span class="n">table</span> <span class="n">output</span><span class="o">.</span><span class="n">file</span> <span class="o">--</span><span class="n">condition</span> <span class="n">Treatment</span> <span class="o">--</span><span class="n">interactions</span> <span class="n">Strain</span>
</pre></div>
</div>
<p>The difference between how covariates and interactions are handeled in the model
is discussed below in the section on Statistical Significance.</p>
</section>
<section id="categorical-vs-numeric-covariates">
<h3>Categorical vs Numeric Covariates<a class="headerlink" href="#categorical-vs-numeric-covariates" title="Permalink to this headline"></a></h3>
<p>In some cases, covariates are intended to be treated as categorical
variables, like ‘batch’ or ‘library’ or ‘medium’.
In other cases, a covariate might be a numeric value, such as
‘time’ or ‘concentration’, in which the ordering of values is
relevant.  The ZINB implementation tries to guess the type of each covariate.
If they are strings, they are treated as discrete factors (each with
their own distinct parameter).  If the given covariate can
be parsed as numbers, the model interprets them as real values.  In this
case, the covariate is treated as a linear factor (regressor), and is
incorporated in the model as a single coefficient, capturing the slope or
trend in the insertion counts as the covariate value increases.</p>
</section>
<section id="statistical-significance-what-the-p-values-mean-in-the-zinb-output">
<h3>Statistical Significance - What the P-values Mean in the ZINB Output<a class="headerlink" href="#statistical-significance-what-the-p-values-mean-in-the-zinb-output" title="Permalink to this headline"></a></h3>
<p>Formally, the P-value is from a likelihood ratio test (LRT) between a
condition-dependent ZINB model (<span class="math notranslate nohighlight">\(m_1\)</span>) and a
condition-independent (null) ZINB model (<span class="math notranslate nohighlight">\(m_0\)</span>).</p>
<div class="math notranslate nohighlight">
\[2 \ ln \frac{L(m_1)}{L(m_0)} \sim \chi^2_{df}\]</div>
<p>where L(.) is the ZINB likelihood function, and <span class="math notranslate nohighlight">\(\chi^2_{df}\)</span> is
the chi-squared distribution with degrees of freedom (df) equal to
difference in the number of parameters bewteen the two models.  The p-value is
calculated based on this distribution.</p>
<p>In a simple case where variability across a set of conditions X is being tested,
you can think of the model approximately as:</p>
<div class="math notranslate nohighlight">
\[m_1: ln \ \mu = \alpha_0+\vec\alpha X\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is an estimate of the mean (non-zero) insertion
count in a gene (a parameter in the likelihood function for ZINB),
<span class="math notranslate nohighlight">\(\alpha_0\)</span> is a constant (the mean across all
conditions), and <span class="math notranslate nohighlight">\(\vec\alpha\)</span> is a vector of coefficients
representing the deviation of the mean count in each condition.
(There is a corresponding equation for estimating the saturation as a
function of condition.)</p>
<p>To evaluate whether the variability across conditions is significant, we
compare to a null model, where the counts are estimated by the global mean only
(dropping the condition variable X).</p>
<div class="math notranslate nohighlight">
\[m_0: ln \ \mu = \alpha_0\]</div>
<p>When a covariate C is available, it is incorporated in both models (additively),
to account for the effect of the covariate in <span class="math notranslate nohighlight">\(m_1\)</span>. Coefficients in <span class="math notranslate nohighlight">\(\vec\beta\)</span>
represent systematic effects on the mean count due to the covariate, and effectively
get subtracted out of the condition coefficients, but <span class="math notranslate nohighlight">\(\vec\beta\)</span> is also
included in the null model <span class="math notranslate nohighlight">\(m_0\)</span>, since we want to discount the effect of C on the
likelihood and focus on evaluting the effect of X.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m_1: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta C\\m_0: ln \ \mu = \alpha_0 + \vec\beta C\end{aligned}\end{align} \]</div>
<p>When an interaction I is being tested, it is incorporated <em>multiplicatively</em> in
the main model <span class="math notranslate nohighlight">\(m_1\)</span> and <em>additively</em> in the null model <span class="math notranslate nohighlight">\(m_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}m_1: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta I + \vec\gamma X*I\\m_0: ln \ \mu = \alpha_0 + \vec\alpha X + \vec\beta I\end{aligned}\end{align} \]</div>
<p>The meaning of this is that the coefficients <span class="math notranslate nohighlight">\(\vec\alpha\)</span> and
<span class="math notranslate nohighlight">\(\vec\beta\)</span> capture the additive effects of how the mean
insertion count in a gene depends on the condition variable and the
interaction variable, respectively, and the X*I term captures
additional (non-additive) deviations (which is the traditional way
interactions are handled in generalized linear models, GLMs).  Thus,
if there were no interaction, one would expect the mean in datasets
representing the <em>combination</em> of X and I to be predicted by the
offsets for each independently.  To the extend that this is not the
case, we say that X and I interaction, and the coefficients
<span class="math notranslate nohighlight">\(\gamma\)</span> for X*I capture these deviations (non-additive
effects).</p>
<p>For example, think of condition X as Strain (e.g. wild-type vs mutant),
and interaction I as Treatment (e.g. treated versus control).
Then the main model would look like this:</p>
<div class="math notranslate nohighlight">
\[m_1: ln \ \mu = \alpha_0 + \alpha_1 WT  + \alpha_2 mutant + \beta_1 control + \beta_2 treated + \gamma mutant * treated\]</div>
<p>and this would be compared to the following null model (without the interaction term):</p>
<div class="math notranslate nohighlight">
\[m_0: ln \ \mu = \alpha_0 + \alpha_1 WT  + \alpha_2 mutant + \beta_1 control + \beta_2 treated\]</div>
</section>
<section id="id41">
<h3>Output and Diagnostics<a class="headerlink" href="#id41" title="Permalink to this headline"></a></h3>
<p>The ZINB method outputs a tab-delimited file with results for each
gene in the genome. P-values are adjusted for multiple comparisons using
the Benjamini-Hochberg procedure (called “q-values” or “p-adj.”). A
typical threshold for conditional essentiality on is q-value &lt; 0.05.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the gene.</p></td>
</tr>
<tr class="row-even"><td><p>TAs</p></td>
<td><p>Number of TA sites in Gene</p></td>
</tr>
<tr class="row-odd"><td><p>Means…</p></td>
<td><p>Mean read-counts for each condition</p></td>
</tr>
<tr class="row-even"><td><p>LFCs…</p></td>
<td><p>Log-fold-change (base 2) of mean insertion count relative to
mean across all conditions. Pseudo-counts of 5 are added.
If only 2 conditions, LFC is based on ratio of second to first.</p></td>
</tr>
<tr class="row-odd"><td><p>NZmeans…</p></td>
<td><p>Mean read-counts at non-zero zites for each condition</p></td>
</tr>
<tr class="row-even"><td><p>NZpercs…</p></td>
<td><p>Saturation (percentage of non-zero sites) for each condition</p></td>
</tr>
<tr class="row-odd"><td><p>p-value</p></td>
<td><p>P-value calculated by the ZINB test.</p></td>
</tr>
<tr class="row-even"><td><p>p-adj</p></td>
<td><p>Adjusted p-value controlling for the FDR (Benjamini-Hochberg)</p></td>
</tr>
<tr class="row-odd"><td><p>status</p></td>
<td><p>Diagnostic information (explanation for genes not analyzed)</p></td>
</tr>
</tbody>
</table>
<p><strong>LFCs</strong> (log-fold-changes):
For each condition, the LFC is calculated as the log-base-2 of the
ratio of mean insertion count in that condition <strong>relative to the
mean of means across all the conditions</strong> (by default).
However, you can change this by desginating a specific reference condition using the flag <strong>--ref</strong>.
(If there are multiple reference conditions, they may be given as a comma separated list.)
(If you are using interactions, it is more complicated to specify a reference condition by name because they have to include the interactions, e.g. as shown in the column headers in the output file.)
Pseudocount are incorporated to reduce the impact of noise on LFCs, based on the formula below.
The pseudocounts can be adjusted using the -PC flag.
Changing the pseudocounts (via -PC) can reduce the artifactual appearance of genes with
high-magnitude LFCs but that have small overall counts (which are susceptible to noise).
Changing the pseudocounts will not affect the analysis of statistical significance and hence number of varying genes, however.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LFC</span> <span class="o">=</span> <span class="n">log2</span><span class="p">((</span><span class="n">mean_insertions_in_condition</span> <span class="o">+</span> <span class="n">PC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mean_of_means_across_all_conditions</span> <span class="o">+</span> <span class="n">PC</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id42">
<h3>Run-time<a class="headerlink" href="#id42" title="Permalink to this headline"></a></h3>
<p>A typical run of the ZINB method takes ~5 minutes to analze a combined wig
file with 6 conditions, 3 replicates per condition. It will, of
course, run more slowly if you have many more conditions.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section id="normalization">
<span id="id43"></span><h2>Normalization<a class="headerlink" href="#normalization" title="Permalink to this headline"></a></h2>
<p>Proper normalization is important as it ensures that other sources of
variability are not mistakenly treated as real differences in
datasets. TRANSIT provides various normalization methods, which are
briefly described below:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>TTR:</strong></dt><dd><p>Trimmed Total Reads (TTR), normalized by the total
read-counts (like totreads), but trims top and bottom 5% of
read-counts. <strong>This is the recommended normalization method for most cases</strong>
as it has the beneffit of normalizing for difference in
saturation in the context of resampling.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>nzmean:</strong></dt><dd><p>Normalizes datasets to have the same mean over the
non-zero sites.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>totreads:</strong></dt><dd><p>Normalizes datasets by total read-counts, and scales
them to have the same mean over all counts.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>zinfnb:</strong></dt><dd><p>Fits a zero-inflated negative binomial model, and then
divides read-counts by the mean. The zero-inflated negative
binomial model will treat some empty sites as belonging to the
“true” negative binomial distribution responsible for read-counts
while treating the others as “essential” (and thus not influencing
its parameters).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>quantile:</strong></dt><dd><p>Normalizes datasets using the quantile normalization
method described by <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/12538238">Bolstad et al.
(2003)</a>. In this
normalization procedure, datasets are sorted, an empirical
distribution is estimated as the mean across the sorted datasets
at each site, and then the original (unsorted) datasets are
assigned values from the empirical distribution based on their
quantiles.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>betageom:</strong></dt><dd><p>Normalizes the datasets to fit an “ideal” Geometric
distribution with a variable probability parameter <em>p</em>. Specially
useful for datasets that contain a large skew. See <a class="reference internal" href="transit_features.html#bgc"><span class="std std-ref">Beta-Geometric Correction</span></a> .</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>nonorm:</strong></dt><dd><p>No normalization is performed.</p>
</dd>
</dl>
</li>
</ul>
<section id="command-line">
<h3>Command-line<a class="headerlink" href="#command-line" title="Permalink to this headline"></a></h3>
<p>In addition to choosing normalization for various analyses in the GUI,
you can also call Transit to normalize wig files from the command-line,
as shown in this example:</p>
</section>
<section id="id44">
<h3>Example<a class="headerlink" href="#id44" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">normalize</span> <span class="o">--</span><span class="n">help</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">normalize</span> <span class="o">&lt;</span><span class="nb">input</span><span class="o">.</span><span class="n">wig</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">.</span><span class="n">wig</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="n">TTR</span><span class="o">|</span><span class="n">betageom</span><span class="p">]</span>
   <span class="ow">or</span><span class="p">:</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">normalize</span> <span class="o">-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">combined_wig</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span> <span class="n">TTR</span><span class="o">|</span><span class="n">betageom</span><span class="p">]</span>

<span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">normalize</span> <span class="n">Rv_1_H37RvRef</span><span class="o">.</span><span class="n">wig</span> <span class="n">Rv_1_H37RvRef_TTR</span><span class="o">.</span><span class="n">wig</span> <span class="o">-</span><span class="n">n</span> <span class="n">TTR</span>

<span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">normalize</span> <span class="n">Rv_1_H37RvRef</span><span class="o">.</span><span class="n">wig</span> <span class="n">Rv_1_H37RvRef_BG</span><span class="o">.</span><span class="n">wig</span> <span class="o">-</span><span class="n">n</span> <span class="n">betageom</span>
</pre></div>
</div>
<p>The normalize command now also works on <a class="reference internal" href="#combined-wig">combined_wig</a> files too.
If the input file is a combined_wig file, indicate it with a ‘-c’ flag.</p>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="pathway-enrichment-analysis">
<h2>Pathway Enrichment Analysis<a class="headerlink" href="#pathway-enrichment-analysis" title="Permalink to this headline"></a></h2>
<p>Pathway Enrichment Analysis provides a method to
identify enrichment of functionally-related genes among those that are
conditionally essential (i.e.
significantly more or less essential between two conditions).
The analysis is typically applied as post-processing step to the hits identified
by a comparative analysis, such as <em>resampling</em>.
Several analytical method are provided:
Fisher’s exact test (FET, hypergeometric distribution), GSEA (Gene Set Enrichment Analysis)
by <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/16199517">Subramanian et al (2005)</a>,
and <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/17848398">Ontologizer</a>.
For Fisher’s exact test,
genes in the resampling output file with adjusted p-value &lt; 0.05 are taken as hits,
and evaluated for overlap with functional categories of genes.
The GSEA methods use the whole list of genes, ranked in order of statistical significance
(without requiring a cutoff), to calculate enrichment.</p>
<p>Three systems of categories are provided for (but you can add your own):
the Sanger functional categories of genes determined in the
original annotation of the H37Rv genome (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/9634230">Cole et al, 1998</a>,
with subsequent updates),
COG categories (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/25428365">Clusters of Orthologous Genes</a>) and
also GO terms (Gene Ontology).  The supporting files for <em>M. tuberculosis</em>
H37Rv are in the src/pytransit/data/ directory.</p>
<p>For other organisms, it might be possible to download COG categories from
<a class="reference external" href="http://www.ncbi.nlm.nih.gov/COG/">http://www.ncbi.nlm.nih.gov/COG/</a>
and GO terms from <a class="reference external" href="http://www.geneontology.org">http://www.geneontology.org</a>
or <a class="reference external" href="http://patricbrc.org">http://patricbrc.org</a>.
If these files can be obtained for your organism, they will have to be converted into
the <em>associations</em> file format described below. (The <em>pathways</em> files for COG categories and GO terms
in the Transit data directory should still work, because they just encode pathways names for all terms/ids.)</p>
<p>At present, pathway enrichment analysis is only implemented as a command-line function,
and is not available in the Transit GUI.</p>
<section id="id45">
<h3>Usage<a class="headerlink" href="#id45" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">pathway_enrichment</span> <span class="o">&lt;</span><span class="n">resampling_file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">associations</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">pathways</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output_file</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">M</span> <span class="o">&lt;</span><span class="n">FET</span><span class="o">|</span><span class="n">GSEA</span><span class="o">|</span><span class="n">ONT</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">PC</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="id46">
<h3>Parameters<a class="headerlink" href="#id46" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Resampling File</strong></dt><dd><p>The resampling file is the one obtained after using the resampling method in Transit. (It is a tab separated file with 11 columns.) GSEA method makes usage of the last column (adjusted P-value)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Associations File</strong></dt><dd><p>This is a tab-separated text file with 2 columns: pathway id, and pathway name. If a gene is in multiple pathways, the associated ids should be listed on separate lines.  It is OK if there are no associations listed for some genes.  Important: if pathways are hierarchical, you should expand this file to explicitly include associations of each gene with all parent nodes. Files with GO term associations will have to be pre-processed this way too.</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span><span class="p">:</span> <span class="n">H37Rv_sanger_roles</span><span class="o">.</span><span class="n">dat</span>

<span class="n">Rv3823c</span>       <span class="n">II</span><span class="o">.</span><span class="n">C</span><span class="mf">.4</span>
<span class="n">Rv3823c</span>       <span class="n">II</span><span class="o">.</span><span class="n">C</span>
<span class="n">Rv3823c</span>       <span class="n">II</span>
<span class="n">Rv0337c</span>       <span class="n">I</span><span class="o">.</span><span class="n">D</span><span class="mf">.2</span>
<span class="n">Rv0337c</span>       <span class="n">I</span><span class="o">.</span><span class="n">D</span>
<span class="n">Rv0337c</span>       <span class="n">I</span>
<span class="o">...</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Pathways File</strong></dt><dd><p>This is a tab-separated text file with 2 columns: pathway id, and pathway name.</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span><span class="p">:</span> <span class="n">sanger_roles</span><span class="o">.</span><span class="n">dat</span>

<span class="n">I</span>     <span class="n">Small</span><span class="o">-</span><span class="n">molecule</span> <span class="n">metabolism</span>
<span class="n">I</span><span class="o">.</span><span class="n">A</span>   <span class="n">Degradation</span>
<span class="n">I</span><span class="o">.</span><span class="n">A</span><span class="mf">.1</span> <span class="n">Carbon</span> <span class="n">compounds</span>
<span class="n">I</span><span class="o">.</span><span class="n">A</span><span class="mf">.2</span> <span class="n">Amino</span> <span class="n">acids</span> <span class="ow">and</span> <span class="n">amines</span>
<span class="n">I</span><span class="o">.</span><span class="n">A</span><span class="mf">.3</span> <span class="n">Fatty</span> <span class="n">acids</span>
<span class="n">I</span><span class="o">.</span><span class="n">A</span><span class="mf">.4</span> <span class="n">Phosphorous</span> <span class="n">compounds</span>
<span class="o">...</span>
</pre></div>
</div>
<ul>
<li><dl>
<dt><strong>-M</strong></dt><dd><p>Methodology to be used. FET is used by default (even without specifying -M).</p>
</dd>
<dt><strong>FET</strong></dt><dd><p>This implements Fisher’s Exact Test (hypergeometric distribution) to determine a p-value for each pathway, based on the proportion of pathway member observed in list of hits (conditionally essential gene by resampling, padj&lt;0.05) compared to the background proportion in the overall genome, and p-values are adjusted post-hoc by the Benjamini-Hochberg procedure to limit the FDR to 5%.</p>
<p>In the output file, an “enrichment score” is reported, which is the ratio of the observed number of pathway members among the hits to the expected number.  Pseudocounts of 2 are included in the calculation to reduce the bias toward small pathways with only a few genes; this can be adjusted with the -PC flag (below).</p>
<p>FET can be used with GO terms.</p>
<p>Additional flags for FET:</p>
<ul class="simple">
<li><p><strong>-PC &lt;int&gt;</strong>: Pseudocounts used in calculating the enrichment score and p-value by hypergeometic distribution. Default: PC=2.</p></li>
</ul>
</dd>
<dt><strong>GSEA</strong></dt><dd><p>Gene Set Enrichment Analysis. GSEA assess the significance of a pathway by looking at how the members fall in the ranking of all genes.  The genes are first ranked by significance from resampling.  Specifically, they are sorted by signed-log-p-value, SLPV=sign(LFC)*(log(pval)), which puts them in order so that the most significant genes with negative LFC are at the top, the most significant with positive LFC are at the bottom, and insignificant genes fall in the middle.  Roughly, GSEA computes the mean rank of pathway members, and evaluates significance based on a simulated a null distribution.  p-values are again adjusted at the end by BH.</p>
<p><a class="reference external" href="http://www.pnas.org/content/102/43/15545.short">Subramanian, A., Tamayo, P., Mootha, V. K., Mukherjee, S., Ebert, B. L., Gillette, M. A., … &amp; Mesirov, J. P. (2005).  `ene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. Proceedings of the National Academy of Sciences, 102(43), 15545-15550.</a></p>
<p>GSEA can be used with GO terms.</p>
<p>Additional flags for GSEA:</p>
<ul class="simple">
<li><p><strong>-ranking SLPV|LFC</strong>: method used to rank all genes; SLPV is signed-log-p-value (default); LFC is log2-fold-change from resampling</p></li>
<li><p><strong>-p &lt;float&gt;</strong>: exponent to use in calculating enrichment score; recommend trying ‘-p 0’ (default) or ‘-p 1’ (as used in Subramaniam et al, 2005)</p></li>
<li><p><strong>-Nperm &lt;int&gt;</strong>: number of permutations to simulate for null distribution to determine p-value (default=10000)</p></li>
</ul>
</dd>
<dt><strong>ONT</strong></dt><dd><p>Ontologizer is a specialized method for GO terms that takes parent-child relationships into account among nodes in the GO hierarchy.  This can enhance the specificity of pathways detected as significant.  (The problem is that there are many GO terms in the hierarchy covering similar or identical sets of genes, and often, if one node is significantly enriched, then several of its ancestors will be too, which obscures the results with redundant hits; Ontologizer reduces the significance of nodes if their probability distribution among hits can be explained by their parents.) Hierarhical relationships among GO terms are encoded in an OBO file, which is included in the src/pytransit/data/ directory.</p>
<p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/17848398">Grossmann S, Bauer S, Robinson PN, Vingron M. Improved detection of overrepresentation of Gene-Ontology annotations with parent child analysis. Bioinformatics. 2007 Nov 15;23(22):3024-31.</a></p>
</dd>
</dl>
<p>For the ONT method in pathway_enrichment, the enrichment for a given
GO term can be expressed (in a simplified way, leaving out the
pseudocounts) as:</p>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enrichment</span> <span class="o">=</span> <span class="n">log</span> <span class="p">(</span>  <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">p</span><span class="p">)</span>  <span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<blockquote>
<div><p>where:</p>
</div></blockquote>
<ul class="simple">
<li><p>b is the number of genes with this GO term in the subset of hits (e.g. conditional essentials from resampling, with qval&lt;0.05)</p></li>
<li><p>q is the number of genes in the subset of hits with a parent of this GO term</p></li>
<li><p>m is the total number of genes with this GO term in the genome</p></li>
<li><p>p is the number of genes in the genome with a parent of this GO term</p></li>
</ul>
<blockquote>
<div><p>So enrichment is the log of the ratio of 2 ratios:</p>
<ol class="arabic simple">
<li><p>the relative abundance of genes with this GO term compared to those with a parent GO term   among the hits</p></li>
<li><p>the relative abundance of genes with this GO term compared to those with a parent GO term   in the whole genome</p></li>
</ol>
</div></blockquote>
</section>
<section id="auxilliary-pathway-files-in-transit-data-directory">
<h3>Auxilliary Pathway Files in Transit Data Directory<a class="headerlink" href="#auxilliary-pathway-files-in-transit-data-directory" title="Permalink to this headline"></a></h3>
<p>These files for pathway analysis are distributed in the Transit data directory
(e.g. transit/src/pytransit/data/).</p>
<p>Note: The “Sanger” roles are custom pathway associations for
<em>M. tuberculosis</em> defined in the original Nature paper on
the H37Rv genome sequence <a class="reference external" href="https://www.nature.com/articles/31159">(Cole et al., 1998)</a> (Table 1).  They are more specific
that COG categories, but less specific than GO terms.  For other
organisms, one should be able to find GO terms (e.g. on PATRIC,
Uniprot, or geneontology.org) and COG roles (from
<a class="reference external" href="https://ftp.ncbi.nih.gov/pub/COG/COG2020/data/">https://ftp.ncbi.nih.gov/pub/COG/COG2020/data/</a>, <a class="reference external" href="https://academic.oup.com/nar/article/49/D1/D274/5964069">(Galerpin et al, 2021)</a> ).</p>
<p>Pathway association files for <em>M. smegmatis</em> mc2 155 are also provided in the table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 18%" />
<col style="width: 33%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>system</p></th>
<th class="head"><p>num roles</p></th>
<th class="head"><p>applicable methods</p></th>
<th class="head"><p>associations of genes with roles</p></th>
<th class="head"><p>pathway definitions/role names</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>COG</p></td>
<td><p>25</p></td>
<td><p>FET*, GSEA</p></td>
<td><p>H37Rv_COG_roles.dat;
smeg_COG_roles.dat</p></td>
<td><p>COG_roles.dat</p></td>
</tr>
<tr class="row-odd"><td><p>Sanger</p></td>
<td><p>153</p></td>
<td><p>FET*, GSEA*</p></td>
<td><p>H37Rv_sanger_roles.dat</p></td>
<td><p>sanger_roles.dat</p></td>
</tr>
<tr class="row-even"><td><p>GO</p></td>
<td><p>2545</p></td>
<td><p>ONT*</p></td>
<td><p>H37Rv_GO_terms.txt;
smeg_GO_terms.txt</p></td>
<td><p>gene_ontology.1_2.3-11-18.obo</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>FET, GSEA</p></td>
<td><p>H37Rv_GO_terms.txt;
smeg_GO_terms.txt</p></td>
<td><p>GO_term_names.dat</p></td>
</tr>
</tbody>
</table>
<p>‘*’ means <em>recommended</em> combination of method with system of functional categories</p>
</section>
<section id="current-recommendations">
<h3>Current Recommendations<a class="headerlink" href="#current-recommendations" title="Permalink to this headline"></a></h3>
<p>Here are the recommended combinations of pathway methods to use for different systems of functional categories:</p>
<blockquote>
<div><ul class="simple">
<li><p>For COG, use ‘-M FET’</p></li>
<li><p>For Sanger roles, try both FET and GSEA</p></li>
<li><p>For GO terms, use ‘M -ONT’</p></li>
</ul>
</div></blockquote>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># uses Fisher&#39;s exact test by default (with PC=2 as pseudocounts)
&gt; transit pathway_enrichment resampling_glyc_chol.txt $DATA/H37Rv_sanger_roles.dat $DATA/sanger_roles.dat pathways_glyc_chol_Sanger.txt

# can do this with GO terms too
&gt; transit pathway_enrichment resampling_glyc_chol.txt $DATA/H37Rv_GO_terms.txt $DATA/GO_term_names.dat pathways_glyc_chol_GO.txt

# with COG categories
&gt; transit pathway_enrichment resampling_glyc_chol.txt $DATA/H37Rv_COG_roles.dat $DATA/COG_roles.dat pathways_glyc_chol_COG.txt

# can also do GSEA method (on any system of functional categories)
&gt; transit pathway_enrichment resampling_glyc_chol.txt $DATA/H37Rv_sanger_roles.dat $DATA/sanger_roles.dat pathways_Sanger_GSEA.txt -M GSEA

# Ontologizer is a specialized method for GO terms
&gt; transit pathway_enrichment resampling_glyc_chol.txt $DATA/H37Rv_GO_terms.txt $DATA/GO_term_names.dat pathways_Ontologizer.txt -M ONT
</pre></div>
</div>
<p>The $DATA environment variable in these examples refers to the Transit data directory, e.g. src/pytransit/data/.</p>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="id48">
<h2>tnseq_stats<a class="headerlink" href="#id48" title="Permalink to this headline"></a></h2>
<p>You can generate the same table to statistics as on the Quality Control panel in the GUI
from the command-line using the ‘tnseq_stats’ command.  Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tnseq_stats</span> <span class="o">--</span><span class="n">help</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tnseq_stats</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">.</span><span class="n">wig</span><span class="o">&gt;+</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output_file</span><span class="o">&gt;</span><span class="p">]</span>
       <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tnseq_stats</span> <span class="o">-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">combined_wig</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">output_file</span><span class="o">&gt;</span><span class="p">]</span>

<span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">tnseq_stats</span> <span class="o">-</span><span class="n">c</span> <span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">cholesterol_glycerol_combined</span><span class="o">.</span><span class="n">dat</span>

<span class="n">dataset</span> <span class="n">density</span> <span class="n">mean_ct</span> <span class="n">NZmean</span>  <span class="n">NZmedian</span>        <span class="n">max_ct</span>  <span class="n">total_cts</span>       <span class="n">skewness</span>        <span class="n">kurtosis</span>
<span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">cholesterol_H37Rv_rep1</span><span class="o">.</span><span class="n">wig</span>   <span class="mf">0.44</span>    <span class="mf">139.6</span>   <span class="mf">317.6</span>   <span class="mi">147</span>     <span class="mf">125355.5</span>        <span class="mf">10414005.0</span>      <span class="mf">54.8</span>    <span class="mf">4237.7</span>
<span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">cholesterol_H37Rv_rep2</span><span class="o">.</span><span class="n">wig</span>   <span class="mf">0.44</span>    <span class="mf">171.4</span>   <span class="mf">390.5</span>   <span class="mi">148</span>     <span class="mf">704662.8</span>        <span class="mf">12786637.9</span>      <span class="mf">105.8</span>   <span class="mf">14216.2</span>
<span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">cholesterol_H37Rv_rep3</span><span class="o">.</span><span class="n">wig</span>   <span class="mf">0.36</span>    <span class="mf">173.8</span>   <span class="mf">484.2</span>   <span class="mi">171</span>     <span class="mf">292294.8</span>        <span class="mf">12968502.500000002</span>      <span class="mf">42.2</span>    <span class="mf">2328.0</span>
<span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">glycerol_H37Rv_rep1</span><span class="o">.</span><span class="n">wig</span>      <span class="mf">0.42</span>    <span class="mf">123.3</span>   <span class="mf">294.5</span>   <span class="mi">160</span>     <span class="mf">8813.3</span>  <span class="mf">9195672.4</span>       <span class="mf">4.0</span>     <span class="mf">33.0</span>
<span class="n">src</span><span class="o">/</span><span class="n">pytransit</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">glycerol_H37Rv_rep2</span><span class="o">.</span><span class="n">wig</span>      <span class="mf">0.52</span>    <span class="mf">123.8</span>   <span class="mf">240.1</span>   <span class="mi">127</span>     <span class="mf">8542.5</span>  <span class="mf">9235984.2</span>       <span class="mf">4.0</span>     <span class="mf">33.5</span>
</pre></div>
</div>
<hr class="transit-sectionend docutils" />
</section>
<section class="transit-clionly" id="id49">
<h2>corrplot<a class="headerlink" href="#id49" title="Permalink to this headline"></a></h2>
<p>A useful tool when evaluating the quality of a collection of TnSeq datasets is to make a
<em>correlation plot</em> of the mean insertion counts (averaged at the gene-level) among samples.
While it is difficult to state unequivocally
how much correlation there should be between samples from different conditions
(or even between replicates of the same condition),
the corrplot can often reveal individual samples which stand out as being far less
correlated with all the others (which subsequently might be excluded from analyses).</p>
<p><strong>Note</strong>: The <em>corrplot</em> command calls R, which must be installed on your system,
and relies on the ‘corrplot’ R package.
See <a class="reference internal" href="transit_install.html#install-zinb"><span class="std std-ref">Installation Instructions</span></a>.</p>
<section id="id50">
<h3>Usage:<a class="headerlink" href="#id50" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">corrplot</span> <span class="o">&lt;</span><span class="n">mean_counts</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">output</span><span class="o">.</span><span class="n">png</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">-</span><span class="n">anova</span><span class="o">|-</span><span class="n">zinb</span><span class="p">]</span>
</pre></div>
</div>
<p>The simplest usage is without the flags at the end.
The mean_counts file is generated by the ‘export mean_counts’ command, and gives
the mean insertion count for each gene in each sample.</p>
<p>Here is an example of making a corrplot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">transit</span> <span class="n">corrplot</span> <span class="n">glyc_chol_combined</span><span class="o">.</span><span class="n">wig</span><span class="o">.</span><span class="n">txt</span> <span class="n">glyc_chol_corrplot</span><span class="o">.</span><span class="n">png</span>
<span class="n">correlations</span> <span class="n">based</span> <span class="n">on</span> <span class="mi">3990</span> <span class="n">genes</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/glyc_chol_corrplot.png"><img alt="_images/glyc_chol_corrplot.png" class="align-center" src="_images/glyc_chol_corrplot.png" style="width: 300px;" /></a>
<p>A corrplot can also be generated from the output of ANOVA or ZINB
analysis, showing relationships among the conditions themselves
(i.e. with replicates merged, rather than correlations among
individual samples).  Importantly, the correlations are based only on
the <em>subset</em> of genes identified as significantly varying (Padj &lt;
0:05) in order to enhance the patterns, since otherwise they would be
washed out by the rest of the genes in the genome, the majority of
which usually do not exhibit significant variation in counts.</p>
<p>Here is an example which generates the following image showing the corrplot among
several different growth conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">corrplot</span> <span class="n">anova_iron</span><span class="o">.</span><span class="n">txt</span> <span class="n">iron_corrplot_anova</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">anova</span>
<span class="n">correlations</span> <span class="n">based</span> <span class="n">on</span> <span class="mi">229</span> <span class="n">genes</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/iron_corrplot_anova.png"><img alt="_images/iron_corrplot_anova.png" class="align-center" src="_images/iron_corrplot_anova.png" style="width: 300px;" /></a>
<p>Note that is an ANOVA or ZINB output file (both of which contain mean
counts for each gene in each condition) is supplied in place of
mean_counts, the <em>last</em> argument of corrplot must be set to either
‘-anova’ or ‘-zinb’ to indicate the type of file being provided as the
first argument.</p>
<p>Note: corrplot requires R (statistical analysis software)
to be installed on your system.  See <a class="reference internal" href="transit_install.html#install-zinb"><span class="std std-ref">Installation Instructions</span></a>.</p>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="id51">
<h2>heatmap<a class="headerlink" href="#id51" title="Permalink to this headline"></a></h2>
<p>The output of ANOVA or ZINB can be used to generate a heatmap that
simultaneously clusters the significant genes and clusters the conditions,
which is especially useful for shedding light on the relationships
among the conditions apparent in the data.</p>
<p><strong>Note:</strong> The <em>heatmap</em> command calls R, which must be installed on your system,
and relies on the ‘gplots’ R package.
See <a class="reference internal" href="transit_install.html#install-zinb"><span class="std std-ref">Installation Instructions</span></a>.</p>
<section id="id52">
<h3>Usage:<a class="headerlink" href="#id52" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">heatmap</span> <span class="o">&lt;</span><span class="n">anova_or_zinb_output</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">heatmap</span><span class="o">.</span><span class="n">png</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">anova</span><span class="o">|-</span><span class="n">zinb</span> <span class="p">[</span><span class="o">-</span><span class="n">topk</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">qval</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">low_mean_filter</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that the first optional argument (flag) is required to be either ‘-anova’ or ‘-zinb’, a flag to
indicate the type of file being provided as the second argument.</p>
<p>By default, genes are selected for the heatmap based on qval&lt;0.05.
However, the user may change the selection of genes through 2 flags:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>-qval &lt;float&gt;</strong>: change qval threshold for selecting genes (default=0.05)</p></li>
<li><p><strong>-topk &lt;int&gt;</strong>: select top k genes ranked by significance (qval)</p></li>
<li><p><strong>-low_mean_filter &lt;int&gt;</strong>: filter out genes with grand mean count (across all conditions) below this threshold (even if qval&lt;0.05); default is to exclude genes with mean count&lt;5</p></li>
</ul>
</div></blockquote>
<p>Here is an example which generates the following image showing the similarities among
several different growth conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python3</span> <span class="n">src</span><span class="o">/</span><span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">heatmap</span> <span class="n">anova_iron</span><span class="o">.</span><span class="n">txt</span> <span class="n">heatmap_iron_anova</span><span class="o">.</span><span class="n">png</span> <span class="o">-</span><span class="n">anova</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/iron_heatmap_anova_rotated.png"><img alt="_images/iron_heatmap_anova_rotated.png" class="align-center" src="_images/iron_heatmap_anova_rotated.png" style="width: 1000px;" /></a>
<p>Importantly, the heatmap is based only on the subset of genes
identified as <em>significantly varying</em> (Padj &lt; 0:05, typically only a few
hundred genes) in order to enhance the patterns, since otherwise they would
be washed out by the rest of the genes in the genome, the majority of
which usually do not exhibit significant variation in counts.</p>
<hr class="transit-sectionend docutils" />
</section>
</section>
<section class="transit-clionly" id="ttn-fitness">
<h2>TTN-Fitness<a class="headerlink" href="#ttn-fitness" title="Permalink to this headline"></a></h2>
<p>TTN-Fitness provides a method for estimating the fitness of genes in a single
condition, while correcting for biases in Himar1 insertion preferences at TA sites
based on surrounding nucleotides. The frequency of insertions depends on nucleotides
surrounding TA sites. This model captures that effect.</p>
<p>Typically with individual TnSeq datasets, Gumbel and HMM are the methods used for
evaluating essentiality. Gumbel distinguishes between ES (essential) from NE (non-essential).
HMM adds the GD (growth-defect; suppressed counts; mutant has reduced fitness) and
GA (growth advantage; inflated counts; mutant has selective advantage) categories.
Quantifying the magnitude of the fitness defect is risky because the counts at
individual TA sites can be noisy. Sometimes the counts at a TA site in a gene can span
a wide range of very low to very high counts. The TTN-Fitness gives a more fine-grained analysis
of the degree of fitness effect by taking into account the insertion preferences of the Himar1 transposon.</p>
<p>These insertion preferences are influenced by the nucleotide context of each TA site.  The TTN-Fitness
method uses a statistical model based on surrounding nucleotides to estimate the insertion bias of each site.
Then, it corrects for this to compute an overall fitness level as a Fitness Ratio, where the ratio is 0 for
ES genes, 1 for typical NE genes, between 0 and 1 for GD genes and above 1 for GA genes.</p>
<p>For additional details, see our paper:</p>
<p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/34665010/">Choudhery, Sanjeevani et al. “Modeling Site-Specific Nucleotide Biases Affecting Himar1 Transposon Insertion
Frequencies in TnSeq Data Sets.” mSystems vol. 6,5 (2021): e0087621. doi:10.1128/mSystems.00876-21</a></p>
<ul class="simple">
<li><p>This methodology is best suited for libraries created with the Himar1 transposon.</p></li>
<li><p>The model itself does not need to be re-trained to make prediction on a dataset. Our data (Choudhery, 2021) shows
this model generalizes across other bacterial species.</p></li>
<li><p>This methodology can handle multiple replicates. More replicates increase the saturation of TA sites in non-essential
genes. This allows for higher accuracy and precision of the insertion counts at TA sites of a genome.</p></li>
</ul>
<p>Note that the TTN-Fitness model is primarily aimed at analyzing GD (growth-defect) genes (and NE, GA) in terms of magnitudes of counts,
but not really ES/ESB genes, which are determined by other analyses (based on absence of insertions). ES genes are
essential genes have been previously labeled as such by the Gumbel method. ESB genes
are genes that have no insertions and are are long enough to be significant by a Binomial
method (see paper).  Since counts are so close to 0 for these, the insertion biased on
the transposon is irrelevant.  Thus, the predictive model is not really used for these genes.</p>
<p>TTN-Fitness is more sensitive to deviations in insertion counts
(compared to expected insertion counts) and therefore tends to call
more GD and GA genes than other analysis methods.</p>
<p>On an average machine, running this methodology on a dataset takes about 5 minutes</p>
<section id="id53">
<h3>Usage<a class="headerlink" href="#id53" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">ttnfitness</span> <span class="o">&lt;</span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span> <span class="o">.</span><span class="n">wig</span> <span class="n">files</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">annotation</span> <span class="o">.</span><span class="n">prot_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">genome</span> <span class="o">.</span><span class="n">fna</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">gumbel</span> <span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">gene</span><span class="o">-</span><span class="n">wise</span> <span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">ta</span><span class="o">-</span><span class="n">site</span> <span class="n">wise</span> <span class="n">output</span> <span class="n">file</span><span class="o">&gt;</span>
<span class="o">-</span>  <span class="n">gumbel</span> <span class="n">output</span> <span class="n">file</span><span class="p">:</span><span class="o">*</span> <span class="n">The</span> <span class="n">Gumbel</span> <span class="n">method</span> <span class="n">must</span> <span class="n">be</span> <span class="n">run</span> <span class="n">first</span> <span class="n">on</span> <span class="n">the</span> <span class="n">dataset</span><span class="o">.</span><span class="n">The</span> <span class="n">output</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Gumbel</span> <span class="n">method</span> <span class="ow">is</span> <span class="n">provided</span> <span class="k">as</span> <span class="n">an</span> <span class="nb">input</span>
   <span class="n">to</span> <span class="n">this</span> <span class="n">method</span><span class="o">.</span> <span class="n">ES</span> <span class="p">(</span><span class="n">essential</span> <span class="n">by</span> <span class="n">Gumbel</span><span class="p">)</span> <span class="ow">and</span> <span class="n">EB</span> <span class="p">(</span><span class="n">essential</span> <span class="n">by</span> <span class="n">Binomial</span><span class="p">)</span> <span class="ow">is</span> <span class="n">calculated</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">TTN</span><span class="o">-</span><span class="n">Fitness</span> <span class="n">method</span> <span class="n">via</span> <span class="n">this</span> <span class="n">files</span>
</pre></div>
</div>
</section>
<section id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline"></a></h3>
<p>There are two outputs files. One file details the assessment per gene and one details the assessment per TA site.</p>
<p>The first output file is a tab-delimited file where the last column, titled TTN-Fitness Calls reports the essentiality call of
each given gene. The call is one of following:</p>
<ul class="simple">
<li><p>NE = Non-essential.</p></li>
<li><p>ES = essential based on Gumbel</p></li>
<li><p>ESB = essential based on Binomial**</p></li>
<li><p>GA = Growth Advantage</p></li>
<li><p>GD = Growth Defect</p></li>
<li><p>U = Uncertain [for genes that are too short]</p></li>
</ul>
<p>** (this is an alternative model for identifying essential genes that complements the Gumbel calculation,
which tends to call short genes with few TA sites Uncertain, especially at lower levels of saturation; see Choudhery et al, 2021)</p>
<p>The Fitness Ratio reported in this file is a modification of the M1 coefficient to reflect the amount of fitness defect per gene.
This ratio was calculated as:</p>
<div class="math notranslate nohighlight">
\[Fitness \ Ratio = e^{(M1\ coefficient - median[M1\ coefficients])}\]</div>
<p>This value ranges from 0 to infinity.
Genes with a value around 1 are non-essential.
If less than 1, this value indicates the level of growth defect
that is caused by disruption of the gene by transpoon insertion.
The closer the ratio of a gene is to 0, the more essential a gene is.
If greater than 1, it indicates the level of growth advantage of the mutant.
The histograms below shows the distribution of the fitness ratios calculated
for each of the essentiality categories. The genes
assessed as GD have a ratio that is typically below 0.5,
those labeled GA are mostly above 1.0 and the ratios of genes assessed
as NE have a peak at 1 and are restricted to the center of the plot.</p>
<a class="reference internal image-reference" href="_images/ttnfitness_coef_distribution.png"><img alt="_images/ttnfitness_coef_distribution.png" class="align-center" src="_images/ttnfitness_coef_distribution.png" style="width: 1000px;" /></a>
<p>The Fitness Ratio quantifies the qualitative calls seen in the TTN-Fitness Calls Column. These two columns are the last two
columns in the output file and are the primary columns per gene reflecting the assessments made by our model.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Orf</p></td>
<td><p>Gene ID.</p></td>
</tr>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Name of the Gene</p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Gene description</p></td>
</tr>
<tr class="row-odd"><td><p>Total # TA Sites</p></td>
<td><p>Total number of TA sites in the Gene</p></td>
</tr>
<tr class="row-even"><td><p>#Sites with insertions</p></td>
<td><p>Number of TA sites in the Gene with insertions</p></td>
</tr>
<tr class="row-odd"><td><p>Gene Saturation</p></td>
<td><p>Percentage of TA sites in the Gene with insertions</p></td>
</tr>
<tr class="row-even"><td><p>Gene+TTN (M1) Coef</p></td>
<td><p>The coefficient of a given gene in M1 model</p></td>
</tr>
<tr class="row-odd"><td><p>Gene+TTN (M1) Adj Pval</p></td>
<td><p>The BF adjusted p-value of a coef of a gene in M1</p></td>
</tr>
<tr class="row-even"><td><p>Mean Insertion Count</p></td>
<td><p>The mean insertion count at TA sites in a given gene</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Fitness Ratio</strong></p></td>
<td><p><strong>Adjusted M1 coefficients to quantify fitness defect per gene</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>TTN-Fitness Assessment</strong></p></td>
<td><p><strong>Calls made for a given gene using the M1 Coef and Adjusted Pval</strong></p></td>
</tr>
</tbody>
</table>
<p>The second output file is a tab-seperated file of details of the TTN Fitness method per TA Site.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column Header</p></th>
<th class="head"><p>Column Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Coord</p></td>
<td><p>Coordinate of TA Site</p></td>
</tr>
<tr class="row-odd"><td><p>Orf</p></td>
<td><p>Gene ID</p></td>
</tr>
<tr class="row-even"><td><p>Name</p></td>
<td><p>Name of the Gene</p></td>
</tr>
<tr class="row-odd"><td><p>Uqstream TTN</p></td>
<td><p>Nucleotides in position 1,2,3 and 4 from the TA site</p></td>
</tr>
<tr class="row-even"><td><p>Downstream TTN</p></td>
<td><p>Reverse Complement of Nucleotides in position -1,-2,-3 and -4 from the TA site</p></td>
</tr>
<tr class="row-odd"><td><p>TTN Fitness Assessment</p></td>
<td><p>Fitness Call for the Gene</p></td>
</tr>
<tr class="row-even"><td><p>Insertion Counts</p></td>
<td><p>Number of Insertions at TA site</p></td>
</tr>
<tr class="row-odd"><td><p>Local Average</p></td>
<td><p>The average number of insertions +5 to -5 from the TA site</p></td>
</tr>
<tr class="row-even"><td><p>M1 Predicted Counts</p></td>
<td><p>TTN+gene based predictions at the TA site using TTN Fitness model</p></td>
</tr>
</tbody>
</table>
</section>
<section id="example-of-running-the-ttn-fitness-methodology-on-the-sample-glycerol-data">
<h3>Example of running the TTN-Fitness methodology on the sample glycerol data<a class="headerlink" href="#example-of-running-the-ttn-fitness-methodology-on-the-sample-glycerol-data" title="Permalink to this headline"></a></h3>
<p>1. Run the Gumbel Analysis</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">gumbel</span> <span class="n">glycerol_H37Rv_rep1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">glycerol_H37Rv_rep2</span><span class="o">.</span><span class="n">wig</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">gylcerol_H37Rv</span><span class="o">.</span><span class="n">gumbel</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>2. Use the output of the Gumbel Analysis as the input to the TTTN-Fitness method</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">transit</span><span class="o">.</span><span class="n">py</span> <span class="n">ttnfitness</span> <span class="n">glycerol_H37Rv_rep1</span><span class="o">.</span><span class="n">wig</span><span class="p">,</span><span class="n">glycerol_H37Rv_rep2</span><span class="o">.</span><span class="n">wig</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">prot_table</span> <span class="n">H37Rv</span><span class="o">.</span><span class="n">fna</span> <span class="n">glycerol_H37Rv</span><span class="o">.</span><span class="n">gumbel</span><span class="o">.</span><span class="n">out</span> <span class="n">ttnfitness_glycerol_H37Rv_gene</span><span class="o">.</span><span class="n">txt</span> <span class="n">ttnfitness_glycerol_H37Rv_TAsite</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>The resulting ttnfitness_glycerol_H37Rv_gene.txt out should contain TTN Fitness Assessments breakdown similar to:</p>
<ul class="simple">
<li><p>172 ES</p></li>
<li><p>501 ESB</p></li>
<li><p>2680 NE</p></li>
<li><p>195 GA</p></li>
<li><p>359 GD</p></li>
<li><p>72 U</p></li>
</ul>
<p>The resulting ttnfitness_glycerol_H37Rv_TAsite.txt should contain 62,622 TA sites</p>
<hr class="transit-sectionend docutils" />
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="transit_features.html" class="btn btn-neutral float-left" title="Quality Control" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="transit_console_cheatsheet.html" class="btn btn-neutral float-right" title="Console Mode Cheat-Sheet" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, Michael A. DeJesus &amp; Thomas R. Ioerger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>